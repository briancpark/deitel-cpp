<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>CLoadDirectDraw Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0223.htm','/dssd0000.htm','/dssd0180.htm','/index.htm','/dssd0225.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="Lib_000106022c000000">CLoadDirectDraw Class</A></H2>
<BR CLEAR=ALL>
<P><IMG SRC="art/vctl05.gif" WIDTH="179" HEIGHT="25" ALT="CLoadDirectDraw class hierarchy" >

<P>DirectShow&#153; must work on multiple platforms; in particular, it also runs on Microsoft&#174; Windows NT&#174; 3.51, which does not have DirectDraw&#174; capabilities. The filters therefore cannot link statically to the DirectDraw library. To make the platform dependencies easier to handle, this class manages loading and unloading the library and creating the initial <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.

<A NAME="Lib_000106022c010000"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0224.htm#Lib_000106022c010100" TARGET="TEXT">CLoadDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0224.htm#Lib_000106022c010200" TARGET="TEXT">GetDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.




</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0224.htm#Lib_000106022c010300" TARGET="TEXT">IsDirectDrawLoaded</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Verifies that DirectDraw is loaded.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0224.htm#Lib_000106022c010500" TARGET="TEXT">LoadDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Loads and initializes the DirectDraw library.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0224.htm#Lib_000106022c010600" TARGET="TEXT">ReleaseDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Releases the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="Lib_000106022c010100">CLoadDirectDraw::CLoadDirectDraw</A></H3>
<A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw Class</A>
<P>Constructs a <A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw</A> object.

<P><B>CLoadDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106022c010200">CLoadDirectDraw::GetDirectDraw</A></H3>
<A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw Class</A>
<P>Retrieves the DirectDraw interface.

<P><B>LPDIRECTDRAW</B> <B>GetDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns a pointer to the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.

<H5>Remarks</H5>
<P>Call <A HREF="dssd0224.htm#Lib_000106022c010500" TARGET="TEXT">CLoadDirectDraw::LoadDirectDraw</A> before calling this member function and call the <A HREF="dssd0224.htm#Lib_000106022c010600" TARGET="TEXT">CLoadDirectDraw::ReleaseDirectDraw</A> member function to release the interface when you are done.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106022c010300">CLoadDirectDraw::IsDirectDrawLoaded</A></H3>
<A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw Class</A>
<P>Verifies that this object loaded DirectDraw.

<P><B>HRESULT</B> <B>IsDirectDrawLoaded</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns S_OK if loaded; otherwise, returns S_FALSE.

<H3><HR COLOR=#0000FF><A NAME="Lib_000106022c010400">CLoadDirectDraw::IsDirectDrawVersion1</A></H3>
<A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw Class</A>
<P>Checks the version of DirectDraw installed on the current system.

<P><B>BOOL</B> <B>IsDirectDrawVersion1</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns TRUE if the installed version of DirectDraw doesn't support the <A HREF="dssd0389.htm#external_00010a0109000056" TARGET="TEXT">IDirectDraw2</A> interface; FALSE if <A HREF="dssd0182.htm#Lib_0001060202010001" TARGET="TEXT">m_pDirectDraw</A> data member is NULL or the installed version of DirectDraw supports <B>IDirectDraw2</B>.

<H5>Remarks</H5>
<P>The video renderer must know what the installed version of DirectDraw is to perform certain tasks, such as full-screen playback, which is supported by the <A HREF="dssd0389.htm#external_00010a0109000056" TARGET="TEXT">IDirectDraw2</A> interface.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106022c010500">CLoadDirectDraw::LoadDirectDraw</A></H3>
<A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw Class</A>
<P>Loads and initializes the DirectDraw library in the specified area.

<P><B>HRESULT</B> <B>LoadDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>LPSTR</B> <I>szDevice</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>szDevice</I>
 </DT><DD>This paramater is optional; if omitted, this method loads DirectDraw to the base drawing area.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if DirectDraw loaded correctly or E_NOINTERFACE otherwise.

<H5>Remarks</H5>
<P>DirectDraw is not always available, so applications cannot statically link to the library. Therefore, this member function loads the library, gets the function entry point addresses, and calls them to create the driver objects. Call this member function before calling <A HREF="dssd0224.htm#Lib_000106022c010200" TARGET="TEXT">CLoadDirectDraw::GetDirectDraw</A> to retrieve the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106022c010600">CLoadDirectDraw::ReleaseDirectDraw</A></H3>
<A HREF="dssd0224.htm" TARGET="TEXT">CLoadDirectDraw Class</A>
<P>Releases the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.

<P><B>void</B> <B>ReleaseDirectDraw</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>This member function is called to release any <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface previously loaded. Call this only when all reference counts have been released.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
