<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IAMMediaStream Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0370.htm','/dssd0000.htm','/dssd0360.htm','/index.htm','/dssd0372.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="mms_face_000108030b000000">IAMMediaStream Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IAMMediaStream</B> interface handles the internal connections between DirectShow filters and filter graphs in applications that use multimedia streaming.

This allows applications to automatically negotiate the transfer and conversion of data from the source to the application without having to write code to handle the connection, transfer of data, data conversion, and actual data rendering or file storage. This provides a uniform and predictable method of data access and control.


<A NAME="mms_face_000108030b010000"></A><P><B>When to Implement</B>
<P>This interface isn't intended for implementation by application developers.

<A NAME="mms_face_000108030b020000"></A><P><B>When to Use</B>
<P>This interface isn't intended for use by application developers.

<A NAME="mms_face_000108030b030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMMediaStream methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description

</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0371.htm#mms_face_000108030b030100" TARGET="TEXT">Initialize</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates and initializes a new media stream with the specified stream type and purpose ID.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0371.htm#mms_face_000108030b030500" TARGET="TEXT">SetState</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the filter state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0371.htm#mms_face_000108030b030200" TARGET="TEXT">JoinAMMultiMediaStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The <A HREF="dssd0370.htm#mms_face_000108030a030100" TARGET="TEXT">IAMMultiMediaStream::AddMediaStream</A> method



 calls this method, which adds the specified media stream to the current multimedia stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0371.htm#mms_face_000108030b030300" TARGET="TEXT">JoinFilter</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects a media stream to a media stream filter in the underlying filter graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0371.htm#mms_face_000108030b030400" TARGET="TEXT">JoinFilterGraph</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects a media stream filter to a filter graph.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="mms_face_000108030b030100">IAMMediaStream::Initialize</A></H3>
<A HREF="dssd0371.htm" TARGET="TEXT">IAMMediaStream Interface</A>
<P>Creates and initializes a new media stream with the specified stream type and purpose ID.
<P><B>HRESULT</B> <B>Initialize</B><B>(</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pSourceObject</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>REFMSPID</B> <I>PurposeID</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TYPE</B> <I>StreamType</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pSourceObject</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> source object.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags. Must be 0.
</DD><DT><I>PurposeID</I>
 </DT><DD>[in] Purpose ID for the new media stream.
</DD><DT><I>StreamType</I>
 </DT><DD>[in] A <A HREF="dssd0372.htm#mm_types_000108030c000100" TARGET="TEXT">STREAM_TYPE</A> enumeration value that specifies the new media stream's media type.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are invalid.

<H3><HR COLOR=#0000FF><A NAME="mms_face_000108030b030200">IAMMediaStream::JoinAMMultiMediaStream</A></H3>
<A HREF="dssd0371.htm" TARGET="TEXT">IAMMediaStream Interface</A>
<P>The <A HREF="dssd0370.htm#mms_face_000108030a030100" TARGET="TEXT">IAMMultiMediaStream::AddMediaStream</A> method


 calls this method, which adds the specified media stream to the current multimedia stream.
<P><B>HRESULT</B> <B>JoinAMMultiMediaStream</B><B>(</B><BR>&nbsp;&nbsp;<B>IAMMultiMediaStream*</B> <I>pAMMultiMediaStream</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pAMMultiMediaStream</I>
 </DT><DD>[in] Specifies the IAMMultiMediaStream to add the current media stream to. 



</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or MS_E_SAMPLEALLOC if the media stream already has allocated stream samples.



<H5>Remarks</H5>
<P>Don't increment the reference count of the supplied multimedia stream as it is already accounted for when created.



<P>This method is not intended to be called by applications.

<H3><HR COLOR=#0000FF><A NAME="mms_face_000108030b030300">IAMMediaStream::JoinFilter</A></H3>
<A HREF="dssd0371.htm" TARGET="TEXT">IAMMediaStream Interface</A>
<P>Connects a media stream to a media stream filter in the underlying filter graph.


<P><B>HRESULT</B> <B>JoinFilter</B><B>(</B> <B>)</B><BR><H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are null.

<H5>Remarks</H5>
<P>Don't increment the reference count for the specified media stream filter.



<P>This method is not intended to be called by applications.

<H3><HR COLOR=#0000FF><A NAME="mms_face_000108030b030400">IAMMediaStream::JoinFilterGraph</A></H3>
<A HREF="dssd0371.htm" TARGET="TEXT">IAMMediaStream Interface</A>
<P>Connects a media stream filter to a filter graph.
<P><B>HRESULT</B> <B>JoinFilterGraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IFilterGraph*</B> <I>pGraph</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pGraph</I>
 </DT><DD>[in] Indicates the current media stream filter to add to the specified filter graph.



</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one or more of the required parameters are null.

<H5>Remarks</H5>
<P>Don't increment the reference count of the specified filter graph.

<P>This method is not intended to be called by applications.

<H3><HR COLOR=#0000FF><A NAME="mms_face_000108030b030500">IAMMediaStream::SetState</A></H3>
<A HREF="dssd0371.htm" TARGET="TEXT">IAMMediaStream Interface</A>
<P>Sets the filter state.
<P><B>HRESULT</B> <B>SetState</B><B>(</B><BR>&nbsp;&nbsp;<B>FILTER_STATE</B> <I>State</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>State</I>
 </DT><DD>[in] Sets the filter's state.



</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_INVALIDARG if the <I>State</I> parameter is invalid..

<H5>Remarks</H5>
<P>This method is not intended to be called by applications.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
