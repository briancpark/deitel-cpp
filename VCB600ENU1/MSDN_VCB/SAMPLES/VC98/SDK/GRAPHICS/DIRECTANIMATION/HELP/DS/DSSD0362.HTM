<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IMediaStream Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0361.htm','/dssd0000.htm','/dssd0360.htm','/index.htm','/dssd0363.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="mms_face_0001080302000000">IMediaStream Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IMediaStream</B> interface provides access to the characteristics of a media stream, such as the stream's media type and purpose ID. It also has methods that create data samples.

<P>For sample code which implements the multimedia streaming interfaces see <A HREF="dssd0375.htm#mm_code_0001080501000000" TARGET="TEXT">Multimedia Streaming Sample Code</A>.

<A NAME="mms_face_0001080302010000"></A><P><B>When to Implement</B>
<P>Implement this interface when you want to add media type-specific functionality to your media stream. This interface is implemented on multimedia stream objects.






 <A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream</A> provides generic sample-creation methods, but you usually want to write a more powerful version of these methods that will take advantage of your media type's specific characteristics.

<A NAME="mms_face_0001080302020000"></A><P><B>When to Use</B>
<P>Use this interface when your application needs to access a stream's media type information and create data samples.



<A NAME="mms_face_0001080302030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaStream methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description

</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0362.htm#mms_face_0001080302030400" TARGET="TEXT">GetMultiMediaStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to the multimedia stream that contains the specified media stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0362.htm#mms_face_0001080302030300" TARGET="TEXT">GetInformation</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the stream's purpose ID and media type.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0362.htm#mms_face_0001080302030600" TARGET="TEXT">SetSameFormat</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the media stream the same format as a previous stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0362.htm#mms_face_0001080302030100" TARGET="TEXT">AllocateSample</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Allocates a new stream sample object for the current media stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0362.htm#mms_face_0001080302030200" TARGET="TEXT">CreateSharedSample</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a new stream sample that shares the same <A HREF="dssd0392.htm#gloss_00010b0103000001" TARGET="TEXT">backing object</A> as the existing sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0362.htm#mms_face_0001080302030500" TARGET="TEXT">SendEndOfStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Forces the current stream to end. If the current stream isn't writable, this method does nothing.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080302030100">IMediaStream::AllocateSample</A></H3>
<A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream Interface</A>
<P>Allocates a new stream sample object for the current media stream.
<P><B>HRESULT</B> <B>AllocateSample</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>IStreamSample</B> <I>**ppSample</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>dwFlags</I>
 </DT><DD>[in] Flags. Must be 0.
</DD><DT><I>ppSample</I>
 </DT><DD>[out] Pointer to the newly created stream sample's <A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample</A> interface.



</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_OUTOFMEMORY
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">There isn't enough memory available to create a stream sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">A parameter is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success; <I>ppSample</I> points to the new sample's <A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample</A> interface.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>This method allocates the sample and its associated backing object or buffer. The backing object is either the <A HREF="dssd0389.htm#external_00010a0109000021" TARGET="TEXT">DirectDraw</A> surface for video or the <A HREF="dssd0369.htm" TARGET="TEXT">IAudioData</A> object for audio.



<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080302030200">IMediaStream::CreateSharedSample</A></H3>
<A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream Interface</A>
<P>Creates a new stream sample that shares the same <A HREF="dssd0392.htm#gloss_00010b0103000001" TARGET="TEXT">backing object</A> as the existing sample.
<P><B>HRESULT</B> <B>CreateSharedSample</B><B>(</B><BR>&nbsp;&nbsp;<B>IStreamSample*</B> <I>pExistingSample</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I> <B>,</B><BR>&nbsp;&nbsp;<B>IStreamSample**</B> <I>ppNewSample</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pExistingSample</I>
 </DT><DD>[in] Pointer to the existing sample.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags. Must be 0.
</DD><DT><I>ppNewSample</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample</A> interface that will point to the newly created shared sample.
</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_OUTOFMEMORY
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">There isn't enough memory available to create the sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One of the parameters is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_E_INCOMPATIBLE
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The existing sample isn't compatible with the specified media stream.



</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success; <I>ppNewSample</I> points to the newly created sample.




</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>This method calls <A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">IUnknown::QueryInterface</A> on the existing sample to retrieve the media type-specific information, which it uses to create the shared sample.

<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080302030300">IMediaStream::GetInformation</A></H3>
<A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream Interface</A>
<P>Retrieves the stream's purpose ID and media type.
<P><B>HRESULT</B> <B>GetInformation</B><B>(</B><BR>&nbsp;&nbsp;<B>MSPID*</B> <I>pPurposeId</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TYPE*</B> <I>pType</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pPurposeId</I>
 </DT><DD>[out] Pointer to an <A HREF="dssd0372.htm#mm_types_000108030c000002" TARGET="TEXT">MSPID</A> value




 that will contain the stream's purpose ID. If this parameter is null on entry, the method won't retrieve the purpose ID.
</DD><DT><I>pType</I>
 </DT><DD>[out] Pointer to a <A HREF="dssd0372.htm#mm_types_000108030c000100" TARGET="TEXT">STREAM_TYPE</A> enumerated data type.



 value that will contain the stream's media type. If this parameter is null on entry, the method won't retrieve the media type.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one of the parameters is invalid.

<H5>Remarks</H5>
<P>You can set either parameter to null on entry, to indicate that the information isn't needed.



<P>The value retrieved in the <I>pPurposeId</I> parameter will usually be either <I>MSPID_PrimaryVideo</I>, which identifies the primary video stream, or <I>MSPID_PrimaryAudio</I>, which identifies the primary audio stream, however other values may be defined by developers if necessary.


<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080302030400">IMediaStream::GetMultiMediaStream</A></H3>
<A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream Interface</A>
<P>Retrieves a pointer to the multimedia stream that contains the specified media stream.
<P><B>HRESULT</B> <B>GetMultiMediaStream</B><B>(</B><BR>&nbsp;&nbsp;<B>IMultiMediaStream**</B> <I>ppMultiMediaStream</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>ppMultiMediaStream</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0361.htm" TARGET="TEXT">IMultiMediaStream</A> interface object that will point to the multimedia stream from which the current media stream was created.



</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if <I>ppMultiMediaStream</I> is invalid.

<H5>Remarks</H5>
<P>This method increments the reference count of the returned object pointer.
<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080302030500">IMediaStream::SendEndOfStream</A></H3>
<A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream Interface</A>
<P>Forces the current stream to end. If the current stream isn't writable, this method does nothing.
<P><B>HRESULT</B> <B>SendEndOfStream</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>dwFlags</I>
 </DT><DD>[in] Flags. Must be 0.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or MS_E_INCOMPATIBLE if the existing sample isn't compatible with the current media stream.




<H5>Remarks</H5>
<P>Applications do not call this internal method.<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080302030600">IMediaStream::SetSameFormat</A></H3>
<A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream Interface</A>
<P>Sets the media stream the same format as a previous stream.
<P><B>HRESULT</B> <B>SetSameFormat</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaStream</B> <I>*pStreamThatHasDesiredFormat</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pStreamThatHasDesiredFormat</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream</A> which has the same format.
</DD><DT><I>dwFlags</I>
 </DT><DD>[in] Flags. Must be 0.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one of the parameters is invalid.

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
