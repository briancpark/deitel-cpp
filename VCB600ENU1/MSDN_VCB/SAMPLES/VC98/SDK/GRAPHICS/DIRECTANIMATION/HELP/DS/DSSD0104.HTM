<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IAMovieSetup Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0103.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0105.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060110000000">IAMovieSetup Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IAMovieSetup</B> interface provides methods that allow objects in a
dynamic-link library (DLL) to be self-registering.
The <B>IAMovieSetup</B> interface works in conjunction with an overall registration architecture
that OLE requires; this architecture is partially implemented in the DirectShow&#153; base classes.
The remainder of the implementation is described in the following sections.

<A NAME="If_0001060110010000"></A><P><B>When to Implement</B>
<P>Implement this interface if you want your filter or plug-in distributor to be able
to register itself automatically as part of a setup routine on an end user system. 
The two methods in this interface, <A HREF="dssd0104.htm#If_0001060110030100" TARGET="TEXT">IAMovieSetup::Register</A> and <A HREF="dssd0104.htm#If_0001060110030200" TARGET="TEXT">IAMovieSetup::Unregister</A>,
are implemented by the <A HREF="dssd0194.htm#Lib_000106020e000000" TARGET="TEXT">CBaseFilter</A> base class for self-registering filters.
For a complete list of steps showing how to use this interface with the DirectShow class library,
see <A HREF="dssd0053.htm" TARGET="TEXT">Register DirectShow Objects</A>.


<A NAME="If_0001060110020000"></A><P><B>When to Use</B>
<P>Use implemented methods on this interface from an entry point on the filter
that is called by a setup utility or installation utility. These are used
automatically by the DirectShow architecture and normally should not need to
be called by any other component.

<A NAME="If_0001060110030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMovieSetup methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0104.htm#If_0001060110030100" TARGET="TEXT">Register</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds the filter to the registry.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0104.htm#If_0001060110030200" TARGET="TEXT">Unregister</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Removes the filter from the registry.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060110030100">IAMovieSetup::Register</A></H3>
<A HREF="dssd0104.htm" TARGET="TEXT">IAMovieSetup Interface</A>
<P>Adds the filter to the registry.

<P><B>HRESULT</B> <B>Register</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method registers the filter, its pins, and the media type associated with the pins.
It should be implemented to use <A HREF="dssd0143.htm" TARGET="TEXT">IFilterMapper</A> methods to accomplish this.
See the <A HREF="dssd0194.htm#Lib_000106020e081400" TARGET="TEXT">CBaseFilter::Register</A> member function for a description of its implementation.
<H3><HR COLOR=#0000FF><A NAME="If_0001060110030200">IAMovieSetup::Unregister</A></H3>
<A HREF="dssd0104.htm" TARGET="TEXT">IAMovieSetup Interface</A>
<P>Removes the filter from the registry.

<P><B>HRESULT</B> <B>Unregister</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value.

<H5>Remarks</H5>
<P>This method should be implemented to use the <A HREF="dssd0143.htm#If_0001060137030600" TARGET="TEXT">IFilterMapper::UnregisterFilter</A>
 method to remove the filter from the registry. This effectively removes the pins and media types as well.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
