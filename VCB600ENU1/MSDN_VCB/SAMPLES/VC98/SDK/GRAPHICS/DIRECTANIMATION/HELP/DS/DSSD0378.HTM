<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IDirectDrawFactory Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0377.htm','/dssd0000.htm','/dssd0376.htm','/index.htm','/dssd0379.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="ddrawex_0001090102000000">IDirectDrawFactory Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IDirectDrawFactory</B> interface is used to create and enumerate DirectDraw objects that support the extended features of DirectDrawEx (see <A HREF="dssd0377.htm" TARGET="TEXT">Using DirectDrawEx</A> for more information). 

<A NAME="ddrawex_0001090102010000"></A><P><B>When to Implement</B>
<P>Do not implement this interface; DirectDrawEx implements it for you.



<A NAME="ddrawex_0001090102020000"></A><P><B>When to Use</B>
<P>Use this interface in an application when you want to create a DirectDrawEx object.

<A NAME="ddrawex_0001090102030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IDirectDrawFactory methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0378.htm#ddrawex_0001090102030100" TARGET="TEXT">CreateDirectDraw</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates a DirectDraw object and retrieves pointers to the <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> and the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0378.htm#ddrawex_0001090102030200" TARGET="TEXT">DirectDrawEnumerate</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Enumerates the DirectDraw surfaces installed on the system.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="ddrawex_0001090102030100">IDirectDrawFactory::CreateDirectDraw</A></H3>
<A HREF="dssd0378.htm" TARGET="TEXT">IDirectDrawFactory Interface</A>
<P>Creates a DirectDraw object and retrieves pointers to the <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> and the <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interfaces.



<P><B>STDMETHOD</B> <B>CreateDirectDraw</B><B>(</B><BR>&nbsp;&nbsp;<B>GUID</B> <B>*</B> <I>pGUID</I><B>,</B><BR>&nbsp;&nbsp;<B>HWND</B> <I>hWnd</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwCoopLevelFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwReserved</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pUnkOuter</I><B>,</B><BR>&nbsp;&nbsp;<B>IDirectDraw</B> <I>**ppDirectDraw</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B><BR><H5>Parameters</H5>
<DL><DT><I>pGUID</I>
 </DT><DD>[out] Pointer to the globally unique identifier (<A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A>) that represents the driver to be created. Set this to NULL



 to indicate the active display driver, or you can pass one of the following flags to restrict the active display driver's behavior for debugging purposes:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDCREATE_EMULATIONONLY
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The DirectDraw object will use emulation for all features; it will not take advantage of any hardware-supported features.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDCREATE_HARDWAREONLY 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The DirectDraw object will never emulate features not supported by the hardware. Attempts to call methods that require unsupported features will fail, returning DDERR_UNSUPPORTED (operation not supported).
</FONT></TD></TR></TABLE>
</DD><DT><I>hWnd</I>
 </DT><DD>[in] Window handle to the application.
</DD><DT><I>dwCoopLevelFlags</I>
 </DT><DD>[in] Application's top-level behavior. Specify one or more of the following flags:
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSCL_ALLOWMODEX 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Enables the use of Mode X display modes. You must use this flag with the DDSCL_EXCLUSIVE and DDSCL_FULLSCREEN flags. </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSCL_ALLOWREBOOT 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Enables <SMALL>CTRL+ALT+DEL</SMALL> to function while in exclusive (full-screen) mode. 



 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSCL_EXCLUSIVE 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Requests the exclusive level.



 You must use this flag with the DDSCL_FULLSCREEN flag. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSCL_FULLSCREEN 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that the exclusive-mode owner will be responsible for the entire primary surface.



 GDI can be ignored.



 You must use this flag with the DDSCL_EXCLUSIVE flag. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSCL_NORMAL 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that the application will function as a regular Windows&#174; application. You can't use this flag with the DDSCL_ALLOWMODEX, DDSCL_EXCLUSIVE, or DDSCL_FULLSCREEN flags. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDSCL_NOWINDOWCHANGES 
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Indicates that DirectDraw can't minimize or restore the application window on activation.


 
</FONT></TD></TR></TABLE>
</DD><DT><I>dwReserved</I>
 </DT><DD>[in] Reserved for future use. Must be NULL.
</DD><DT><I>pUnkOuter</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> interface on an outer object that will be aggregated with an inner object's <B>IUnknown</B> interface.
</DD><DT><I>ppDirectDraw</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns DD_OK if successful, or one of the following error values otherwise:



<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_OUTOFMEMORY </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">There isn't enough memory available to create a DirectDrawEx object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_GENERIC </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">There is an undefined error condition. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_UNSUPPORTED </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The operation isn't supported.



</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_DIRECTDRAWALREADYCREATED </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">A DirectDrawEx object representing this driver has already been created for this process. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDDIRECTDRAWGUID </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A> passed to this method is not a valid DirectDrawEx driver identifier. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_INVALIDPARAMS </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One or more of the parameters passed to the method are incorrect. 
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">DDERR_NODIRECTDRAWHW </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Hardware-only DirectDrawEx object creation isn't possible; the driver doesn't support any hardware. 
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>This method creates DirectDraw objects in the same way that the <A HREF="dssd0389.htm#external_00010a0109000022" TARGET="TEXT">DirectDrawCreate</A> function is used to create DirectDraw objects, and sets <A HREF="dssd0389.htm#external_00010a010900000f" TARGET="TEXT">cooperative level</A>s the same way the <A HREF="dssd0389.htm#external_00010a0109000058" TARGET="TEXT">IDirectDraw2::SetCooperativeLevel</A> method sets cooperative levels.



 However, in addition to creating a DirectDraw object, successful calls to the <B>IDirectDrawFactory::CreateDirectDraw</B> method will obtain a pointer to the <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> and <A HREF="dssd0389.htm#external_00010a0109000041" TARGET="TEXT">IDirectDraw</A> interfaces, which are exposed on the DirectDraw object. Applications can now query



 to obtain the address of a pointer to an <A HREF="dssd0379.htm" TARGET="TEXT">IDirectDraw3</A> interface. 

<H3><HR COLOR=#0000FF><A NAME="ddrawex_0001090102030200">IDirectDrawFactory::DirectDrawEnumerate</A></H3>
<A HREF="dssd0378.htm" TARGET="TEXT">IDirectDrawFactory Interface</A>
<P>Enumerates the DirectDraw objects installed on the system.



<P><B>STDMETHOD</B> <B>DirectDrawEnumerate</B><B>(</B><BR>&nbsp;&nbsp;<B>LPDDENUMCALLBACK</B> <I>lpCallback</I><B>,</B><BR>&nbsp;&nbsp;<B>LPVOID</B> <I>lpContext</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpCallback</I>
 </DT><DD>[in] Pointer to a <A HREF="dssd0389.htm#external_00010a010900001a" TARGET="TEXT">DDEnumCallback</A> function that will be called with a description of each DirectDrawEx-enabled hardware abstraction layer (HAL) installed in the system.



</DD><DT><I>lpContext</I>
 </DT><DD>[in] Address of an application-defined structure that will be passed to the callback function each time the function is called.



</DD></DL>
<H5>Return Values</H5>
<P>Returns DD_OK if successful, or DDERR_INVALIDPARAMS otherwise.




<H5>Remarks</H5>
<P>This method functions in a similar manner to the <B>DirectDrawEnumerate</B> function, defined in the DirectX SDK.

<P><B>Note</B>  This method can only be called by your application



 after a successful call to the <A HREF="dssd0378.htm#ddrawex_0001090102030100" TARGET="TEXT">IDirectDrawFactory::CreateDirectDraw</A> method.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
