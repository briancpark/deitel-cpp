<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>ICaptureGraphBuilder Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0118.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0120.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_000106011f000000">ICaptureGraphBuilder Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>ICaptureGraphBuilder</B> interface enables you to build capture graphs, preview graphs, file recompression graphs, or even unusual custom graphs easily. See <A HREF="dssd0052.htm" TARGET="TEXT">Recompress an AVI File</A> for more information.

<A NAME="If_000106011f010000"></A><P><B>When to Implement</B>
<P>Do not implement this interface. DirectShow already does so.




<A NAME="If_000106011f020000"></A><P><B>When to Use</B>
<P>Use this interface in your capture and recompression applications to make it easier to build filter graphs.

<A NAME="If_000106011f030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>ICaptureGraphBuilder methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030700" TARGET="TEXT">SetFiltergraph</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Tells the graph builder object which filter graph to use.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030500" TARGET="TEXT">GetFiltergraph</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the filter graph that the builder is using.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030800" TARGET="TEXT">SetOutputFileName</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Creates the rendering section of the filter graph, which will save bits to disk with the specified file name.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030400" TARGET="TEXT">FindInterface</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Looks for the specified interface on the filter, upstream and downstream from the filter, and, optionally, on the output pin of the given category.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030600" TARGET="TEXT">RenderStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Connects a source filter's pin, of an optionally specified category, to the rendering filter, and optionally through another filter.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030200" TARGET="TEXT">ControlStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sends stream control messages to the pin of the specified category on one or more capture filters in a graph. 

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030100" TARGET="TEXT">AllocCapFile</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Preallocates a capture file to a specified size.

</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0119.htm#If_000106011f030300" TARGET="TEXT">CopyCaptureFile</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Copies the valid media data from the preallocated capture file.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_000106011f030100">ICaptureGraphBuilder::AllocCapFile</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Preallocates a capture file to a specified size.

<P><B>HRESULT</B> <B>AllocCapFile</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCOLESTR</B> <I>lpwstr</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORDLONG</B> <I>dwlSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpwstr</I>


 </DT><DD>[in] Pointer to a Unicode string containing the name of the file to create or resize.
</DD><DT><I>dwSize</I>
 </DT><DD>[in] Size, in bytes, of the file to be allocated.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>The call will fail if the file is read-only. For best capture results, always capture to a defragmented, preallocated capture file that is larger than the size of the capture data.

<P>Note that under the current DirectShow implementation of this interface, a call to this method will be much quicker on a Windows 95 platform than it will be on a Windows NT platform.


<H3><HR COLOR=#0000FF><A NAME="If_000106011f030200">ICaptureGraphBuilder::ControlStream</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Sends stream control messages to the pin of the specified category on one or more capture filters in a graph.
<P><B>HRESULT</B> <B>ControlStream</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <I>*pCategory</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>*pFilter</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*pstart</I><B>,</B><BR>&nbsp;&nbsp;<B>REFERENCE_TIME</B> <I>*pstop</I><B>,</B><BR>&nbsp;&nbsp;<B>WORD</B> <I>wStartCookie</I><B>,</B><BR>&nbsp;&nbsp;<B>WORD</B> <I>wStopCookie</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pCategory</I>
 </DT><DD>[in] Pointer to a GUID specifying the output pin category. Typical values include the following. See <A HREF="dssd0289.htm#propset_0001060701030100" TARGET="TEXT">AMPROPERTY_PIN</A> for a list of all pin categories. NULL indicates control all capture filters in the graph.
<UL><LI><A HREF="dssd0289.htm#propset_0001060701030102" TARGET="TEXT">PIN_CATEGORY_CAPTURE</A>
<LI><A HREF="dssd0289.htm#propset_0001060701030103" TARGET="TEXT">PIN_CATEGORY_PREVIEW</A>
<LI>NULL
</UL>
</DD><DT><I>pFilter</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface on the filter to control. Specifying NULL controls all capture filters in the graph. You will get one notification for each capture filter.
</DD><DT><I>pstart</I>
 </DT><DD>[in] Pointer to the start time for capture. NULL means start now. <B><A NAME="If_000106011f030201">MAX_TIME</A></B> means cancel previous request, or take no action if there is no previous request.
</DD><DT><I>pstop</I>
 </DT><DD>[in] Pointer to the stop time for capture. NULL means stop now. <I>MAX_TIME</I> means cancel previous request, or take no action if there is no previous request.
</DD><DT><I>wStartCookie</I>
 </DT><DD>[in] Specifies a particular value to be sent when the start occurs.
</DD><DT><I>wStopCookie</I>
 </DT><DD>[in] Specifies a particular value to be sent when the stop occurs.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns S_FALSE if the stop notification is sent before the last sample sent by the capture filter is rendered, otherwise returns S_OK. 

<P>If this method returns S_FALSE, the application might want to wait before destroying the filter graph to allow all samples to pass through the graph and be rendered. Otherwise, samples might be lost.

<P>If a capture filter does not support the <A HREF="dssd0106.htm" TARGET="TEXT">IAMStreamControl</A> interface on its preview pin, the filter should return the failure code E_NOINTERFACE in response to a call to this method. 

<H5>Remarks</H5>
<P>Use this method for frame-accurate capture, or for individual control of capture and preview. For example, you could turn off writing of the captured image to disk if you only want to preview the captured image.

<P>This method calls the <A HREF="dssd0106.htm" TARGET="TEXT">IAMStreamControl</A> interface on the pins. 

<P>This method sends one notification for each filter found with a pin of the specified category.
<H3><HR COLOR=#0000FF><A NAME="If_000106011f030300">ICaptureGraphBuilder::CopyCaptureFile</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Copies the valid media data from the preallocated capture file.
<P><BR><B>HRESULT</B> <B>CopyCaptureFile</B><B>(</B><BR>&nbsp;&nbsp;<B>[in]</B> <B>LPOLESTR</B> <I>lpwstrOld</I><B>,</B><BR>&nbsp;&nbsp;<B>[in]</B> <B>LPOLESTR</B> <I>lpwstrNew</I><B>,</B><BR>&nbsp;&nbsp;<B>[in]</B> <B>int</B> <I>fAllowEscAbort</I><B>,</B><BR>&nbsp;&nbsp;<B>[in]</B> <B>IAMCopyCaptureFileProgress</B> <I>*pCallback</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>lpwstrOld</I>
 </DT><DD>[in] Pointer to a Unicode string containing the source file name.
</DD><DT><I>lpwstrNew</I>
 </DT><DD>[in] Pointer to a Unicode string containing the destination file name. Valid data is copied to this file.
</DD><DT><I>fAllowEscAbort</I>
 </DT><DD>[in] TRUE indicates that pressing the <SMALL>ESC</SMALL> key aborts the copy operation, FALSE indicates that this method will ignore that keystroke.
</DD><DT><I>pCallback</I>
 </DT><DD>[in] Optional pointer to an <A HREF="dssd0094.htm" TARGET="TEXT">IAMCopyCaptureFileProgress</A> interface that you implement to show the progress (percentage complete) of the copy operation.

</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>The new file will contain only valid data and therefore can be much shorter than the source file. Typically, you will always capture to the same huge preallocated file and use this method to copy the data you want to save from each capture to a new file.

<P>If you specify <I>pCallback</I>, the <A HREF="dssd0094.htm#If_0001060106030100" TARGET="TEXT">Progress</A> method on the <A HREF="dssd0094.htm" TARGET="TEXT">IAMCopyCaptureFileProgress</A> interface will be called periodically with an integer between 0 and 100 representing the percentage complete. 
<H3><HR COLOR=#0000FF><A NAME="If_000106011f030400">ICaptureGraphBuilder::FindInterface</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Looks for the specified interface on the filter, upstream and downstream from the filter, and, optionally, on the output pin of the given category.
<P><B>HRESULT</B> <B>FindInterface</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <I>*pCategory</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>*pf</I><B>,</B><BR>&nbsp;&nbsp;<B>REFIID</B> <I>riid</I><B>,</B><BR>&nbsp;&nbsp;<B>void</B> <I>**ppint</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><BR><H5>Parameters</H5>
<DL><DT><I>pCategory</I>
 </DT><DD>[in] Pointer to a GUID specifying the output pin category. Typical values include the following. See <A HREF="dssd0289.htm#propset_0001060701030100" TARGET="TEXT">AMPROPERTY_PIN</A> for a list of all pin categories. NULL indicates search the output pin regardless of category.
<UL><LI><A HREF="dssd0289.htm#propset_0001060701030102" TARGET="TEXT">PIN_CATEGORY_CAPTURE</A>
<LI><A HREF="dssd0289.htm#propset_0001060701030103" TARGET="TEXT">PIN_CATEGORY_PREVIEW</A>
<LI>NULL
</UL>
</DD><DT><I>pf</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface that is the capture filter.
</DD><DT><I>riid</I>
 </DT><DD>[in] Reference ID of the desired interface. 
</DD><DT><I>ppint</I>
 </DT><DD>[out] Address of a void pointer. If the interface was found, this method initializes <I>ppint</I> so that it contains the address of a pointer to the found interface. Call the <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> method to decrement the reference count when you're done with the interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>This method also looks upstream and downstream of the pin for the interface, to find interfaces on renderers, multiplexers, TV tuners, and so forth.
<H3><HR COLOR=#0000FF><A NAME="If_000106011f030500">ICaptureGraphBuilder::GetFiltergraph</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Retrieves the filter graph that the builder is using.
<P><B>HRESULT</B> <B>GetFiltergraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IGraphBuilder</B> <I>**ppfg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>ppfg</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder</A> interface.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 


<H5>Remarks</H5>
<P>This method increments the reference count on the <A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder</A> interface; be sure to decrement the reference count on <B>IGraphBuilder</B> by calling the <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> method.

<H3><HR COLOR=#0000FF><A NAME="If_000106011f030600">ICaptureGraphBuilder::RenderStream</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Connects a source filter's pin, of an optionally specified category, to the rendering filter, and optionally through another filter.
<P><B>HRESULT</B> <B>RenderStream</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <I>*pCategory</I><B>,</B><BR>&nbsp;&nbsp;<B>IMoniker</B> <I>*pMSource</I><B>,</B><BR>&nbsp;&nbsp;<B>IUnknown</B> <I>*pSource</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>*pfCompressor</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>*pfRenderer</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pCategory</I>
 </DT><DD>[in] Pointer to a GUID specifying which output pin of the source filter to connect. Typical values include the following. See <A HREF="dssd0289.htm#propset_0001060701030100" TARGET="TEXT">AMPROPERTY_PIN</A> for a list of all pin categories. NULL indicates render the only output pin, regardless of category.
<UL><LI><A HREF="dssd0289.htm#propset_0001060701030102" TARGET="TEXT">PIN_CATEGORY_CAPTURE</A>
<LI><A HREF="dssd0289.htm#propset_0001060701030103" TARGET="TEXT">PIN_CATEGORY_PREVIEW</A>
<LI>NULL
</UL>
</DD><DT><I>pMSource</I>
 </DT><DD>[in] Moniker for categorized filters, retrieved from device enumeration. Only needed for building WDM capture filter graphs where other filters need to be instantiated for capture, such as TV tuner and crossbar filters. Can be NULL.
</DD><DT><I>pSource</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> or an <A HREF="dssd0165.htm" TARGET="TEXT">IPin</A> interface representing either the source filter or an output pin. Source filters are typically a file source filter, such as an AVI file source filter or a capture filter. For a capture filter, obtain this parameter from the same device enumeration call as <I>pMSource</I>.
</DD><DT><I>pfCompressor</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface representing the optional compression filter.
</DD><DT><I>pfRenderer</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface representing the renderer. You can use the <I>ppf</I> (multiplexer) parameter from <A HREF="dssd0119.htm#If_000106011f030800" TARGET="TEXT">ICaptureGraphBuilder::SetOutputFileName</A> to supply this value.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>If you specify <A HREF="dssd0289.htm#propset_0001060701030102" TARGET="TEXT">PIN_CATEGORY_CAPTURE</A> for <I>pCategory</I>, a capture filter for <I>pSource</I>, and specify a moniker for <I>pMSource</I>, this method instantiates and connects additional required upstream filters, such as TV tuners and crossbars. It then renders the capture pin of <I>pSource</I>. 

<P>If <I>pSource</I> is a pin, then specify NULL for <I>pCategory</I> and <I>pMSource</I> and this method renders the stream from that pin.

<P>If the source filter has only one output pin, specify NULL for <I>pCategory</I>.

<P>All required filters must be present in the graph before the application calls this method.
<H3><HR COLOR=#0000FF><A NAME="If_000106011f030700">ICaptureGraphBuilder::SetFiltergraph</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Tells the graph builder object which filter graph to use.
<P><B>HRESULT</B> <B>SetFiltergraph</B><B>(</B><BR>&nbsp;&nbsp;<B>IGraphBuilder</B> <I>*pfg</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pfg</I>
 </DT><DD>[in] Pointer to an <A HREF="dssd0146.htm" TARGET="TEXT">IGraphBuilder</A> interface that specifies the filter graph to use for subsequent calls to the <A HREF="dssd0140.htm#If_0001060134030100" TARGET="TEXT">IFilterGraph::AddFilter</A> method. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H5>Remarks</H5>
<P>The graph builder will automatically create a filter graph if you don't call this method. If you call this method after the graph builder has created its own filter graph, the call will fail.
<H3><HR COLOR=#0000FF><A NAME="If_000106011f030800">ICaptureGraphBuilder::SetOutputFileName</A></H3>
<A HREF="dssd0119.htm" TARGET="TEXT">ICaptureGraphBuilder Interface</A>
<P>Creates the rendering section of the filter graph, which will save bits to disk with the specified file name.
<P><B>HRESULT</B> <B>SetOutputFileName</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>GUID</B> <I>*pType</I><B>,</B><BR>&nbsp;&nbsp;<B>LPCOLESTR</B> <I>lpwstrFile</I><B>,</B><BR>&nbsp;&nbsp;<B>IBaseFilter</B> <I>**ppf</I><B>,</B><BR>&nbsp;&nbsp;<B>IFileSinkFilter</B> <I>**pSink</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pType</I>
 </DT><DD>[in] Pointer to a <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A> representing the media subtype. Must be
<P><FONT FACE="Courier New">&amp;MEDIASUBTYPE_Avi</FONT> 
<P>because AVI is currently the only supported output format. 
</DD><DT><I>lpwstrFile</I>
 </DT><DD>[in] Pointer to a Unicode string containing the output file name.
</DD><DT><I>ppf</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0116.htm" TARGET="TEXT">IBaseFilter</A> interface representing the multiplexer filter.

 This method increments the reference count on the <B>IBaseFilter</B> interface so you must decrement the reference count by using 
the <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> method on this parameter when done using the filter. 


</DD><DT><I>pSink</I>
 </DT><DD>[out] Address of a pointer to an <A HREF="dssd0137.htm" TARGET="TEXT">IFileSinkFilter</A> interface representing the file writer. This method increments the reference count on the <B>IFileSinkFilter</B> interface so you must decrement the reference count using <A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> when done using the filter. 


</DD></DL>
<H5>Return Values</H5>
<P><TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning 
 </B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_FAIL </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Failure.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_INVALIDARG </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Invalid argument. Audio-video interleaved (AVI) is the only supported output format.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_OUTOFMEMORY </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Out of memory.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Null pointer argument.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_UNEXPECTED </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Unexpected error occurred.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">NOERROR </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
 </FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Instance of the AVI multiplexer filter was successfully created.

</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>This method inserts the multiplexer and the file writer into the filter graph and calls <A HREF="dssd0137.htm#If_0001060131030200" TARGET="TEXT">IFileSinkFilter::SetFileName</A> to set the output file name.

<P>You can use the <I>ppf</I> parameter returned by this method as the <I>pfRenderer</I> parameter in calls to <A HREF="dssd0119.htm#If_000106011f030600" TARGET="TEXT">RenderStream</A>.

<P>You can use the <I>pSink</I> parameter from this method in a call to <A HREF="dssd0137.htm#If_0001060131030200" TARGET="TEXT">SetFileName</A> to change the file name set by <B>ICaptureGraphBuilder::SetOutputFileName</B>. 

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
