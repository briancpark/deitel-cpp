<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>DAGeometry Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/DA_E0043.htm','/DA_E0000.htm','/DA_E0030.htm','/index.htm','/DA_E0045.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="vref_000106010e000000">DAGeometry Class</A></H2>
<BR CLEAR=ALL>
<P>The <B>DAGeometry</B> class is a class of three-dimensional objects that includes surfaces, lights, sounds, their attributes, and/or combinations of these elements. Like other DirectAnimation objects, the value of the elements of the geometry can change over time.

<P>In general, every geometry behavior is spatially infinite and of infinite resolution. Conceptually, each of the infinitely many points in the geometry has associated with it an opacity value, a color, a normal (used for lighting computations), a texture coordinate, a detectability value, and a single-channel sound emanating from that point (generally, this is silence).

<P>Surface geometry is either detectable or not. If a surface is detectable, the geometry fires an event whenever the cursor passes over a surface point. Neither lights nor sounds are detectable (or pickable). 

<P>Light geometries include ambient lights, directional lights, point lights, and spotlights. Light geometries can be attributed with both color and distance attenuation. 

<P>A texture in a geometry is an image, the points of which are mapped to the surface of the three-dimensional object represented by the geometry. If there is no surface in the geometry, the texture is ignored. 

<P>A geometry can also be a sound. The sound is audible when the geometry is within the appropriate range of a microphone behavior.

<P>The bounding box query is used to construct and compose media, and different types of images and behaviors provide specific bounding boxes. This means, for example, that the bounding box of an image is not defined as the smallest axis-aligned, enclosing region of the non-transparent parts of an image. Instead, bounding boxes are defined on a per-operation basis. The <I>emptyGeometry</I> object, for example, has its own definition of a bounding box, defined below.

<P>This class inherits from <A HREF="DA_E0035.htm" TARGET="TEXT">DABehavior</A>.


<UL><LI><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010000" TARGET="TEXT">DAGeometry Functions</A>
<LI><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e020000" TARGET="TEXT">DAGeometry Properties</A>
<LI><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e030000" TARGET="TEXT">Relevant Functions from the DAStatics Class</A>
<LI><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e040000" TARGET="TEXT">Relevant Properties from the DAStatics Class</A>
</UL>
<H3><A NAME="vref_000106010e010000">DAGeometry Functions</A></H3>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010100" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">DiffuseColor</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010200" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">LightAttenuationAnim</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010300" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">LightAttenuation</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010400" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">LightColor</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010500" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">OpacityAnim</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010600" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">Opacity</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010700" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">Pickable</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010800" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">Render</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010900" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">RenderSound</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010a00" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">Texture</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010b00" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">Transform</A><BR>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e010c00" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">Undetectable</A><BR>
<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010100">DiffuseColor</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Specifies the diffuse color of the new <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object. The diffuse color is the diffuse (or matte) reflective color of the surface. By default, the diffuse color is white. The bounding box is the bounding box of the underlying geometry.

<P><B>geometryObj.DiffuseColor</B><B>(</B><BR>&nbsp;&nbsp;<I>col</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>col</I>
 </DT><DD>The <A HREF="DA_E0038.htm" TARGET="TEXT">DAColor</A> object that is the color.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>This attribute overrides previous values.

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010200">LightAttenuationAnim</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> in which any light sources have the given attenuation. The new attenuation is set to 1 / (<I>const</I> + <I>linear</I> <FONT FACE="Symbol">&#180;</FONT> <I>d</I> + <I>quadratic</I> <FONT FACE="Symbol">&#180;</FONT> <I>d</I><SUP>2</SUP>) where <I>d</I> is the distance from the light to the object. By default, the attenuation coefficients are (1, 0, 0), which means no light attenuation. The bounding box is the bounding box of the underlying geometry.

<P><B>geometryObj.LightAttenuationAnim</B><B>(</B><BR>&nbsp;&nbsp;<I>const</I><B>,</B><BR>&nbsp;&nbsp;<I>linear</I><B>,</B><BR>&nbsp;&nbsp;<I>quadratic</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>const</I>, <I>linear</I>, and <I>quadratic</I>
 </DT><DD>The <A HREF="DA_E0054.htm" TARGET="TEXT">DANumber</A> objects specifying the attenuation of a light source. These must be animated numbers.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>An attenuation of (1, 1, 0) gives a linear attenuation that is useful for light falloff in a room. An attenuation of (1, 0, 1) gives a quadratic attenuation that simulates lights that are in the open, such as street lamps and headlights. This attribute overrides previous values. 

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010300">LightAttenuation</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Same as <A HREF="DA_E0044.htm#vref_000106010e010200" TARGET="TEXT">LightAttenuationAnim</A> except that the arguments are non-animated numbers (doubles).

<P><B>geometryObj.LightAttenuation</B><B>(</B><BR>&nbsp;&nbsp;<I>const</I><B>,</B><BR>&nbsp;&nbsp;<I>linear</I><B>,</B><BR>&nbsp;&nbsp;<I>quadratic</I><BR>&nbsp;&nbsp;<B>)</B><BR><H4><HR COLOR=#0000FF><A NAME="vref_000106010e010400">LightColor</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a new <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object in which all embedded lights have the specified color. By default, a light source is white. The bounding box is the bounding box of the underlying geometry.

<P><B>geometryObj.LightColor</B><B>(</B><BR>&nbsp;&nbsp;<I>col</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>col</I>
 </DT><DD>The <A HREF="DA_E0038.htm" TARGET="TEXT">DAColor</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>This attribute overrides previous values.

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010500">OpacityAnim</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Sets the opacity value for all surfaces to <I>opac</I>. Opacity values can range from 0.0 to 1.0. If the corresponding <A HREF="DA_E0054.htm" TARGET="TEXT">DANumber</A> object has a value outside this range, the integer part of the value is discarded and only the fractional part is used. By default, the opacity is 1.

<P><B>geometryObj.OpacityAnim</B><B>(</B><BR>&nbsp;&nbsp;<I>opac</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>opac</I>
 </DT><DD>The <A HREF="DA_E0054.htm" TARGET="TEXT">DANumber</A> object representing the opacity value. The geometry is fully opaque if the value is 1, and fully transparent if the value is 0. This must be an animated number.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>This function composes values. The resulting opacity is the new value times the old value.

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010600">Opacity</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Same as <A HREF="DA_E0044.htm#vref_000106010e010500" TARGET="TEXT">OpacityAnim</A> except that <I>opac</I> is a non-animated number (a double).

<P><B>geometryObj.Opacity</B><B>(</B><BR>&nbsp;&nbsp;<I>opac</I><BR>&nbsp;&nbsp;<B>)</B><BR><H4><HR COLOR=#0000FF><A NAME="vref_000106010e010700">Pickable</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Makes a <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object pickable. Use this function along with the returned <A HREF="DA_E0057.htm" TARGET="TEXT">DAPickableResult</A> object to create a reactive behavior (This means that, when the mouse is in the pickable area, an event occurs).

<P>The behavior of a "pickable" image is identical to that of an ordinary image until the mouse is in the pickable region and there are no geometries (other than <A HREF="DA_E0044.htm#vref_000106010e010c00" TARGET="TEXT">undetectable</A> ones) between it and the mouse. Then, an event (created in <A HREF="DA_E0057.htm" TARGET="TEXT">DAPickableResult</A>) occurs.

<P><B>geometryObj.Pickable</B><B>(</B> <B>)</B><BR><H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0057.htm" TARGET="TEXT">DAPickableResult</A> object. 
 

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010800">Render</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a <A HREF="DA_E0045.htm" TARGET="TEXT">DAImage</A> object that is a two-dimensional projection of <I>geometryObj</I>. The <I>camera</I> parameter defines how the geometry is projected into two dimensions. The resulting image is infinite in extent. The bounding box of a rendered geometry is the axis-aligned extent of the projection of the three-dimensional bounding box onto the image plane.

<P><B>geometryObj.Render</B><B>(</B><BR>&nbsp;&nbsp;<I>camera</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>camera</I>
 </DT><DD>The <A HREF="DA_E0037.htm" TARGET="TEXT">DACamera</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0045.htm" TARGET="TEXT">DAImage</A> object.


<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010900">RenderSound</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a <A HREF="DA_E0060.htm" TARGET="TEXT">DASound</A> object that represents the sound associated with <I>geometryObj</I> as detected by the given microphone.

<P><B>geometryObj.RenderSound</B><B>(</B><BR>&nbsp;&nbsp;<I>mic</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>mic</I>
 </DT><DD>The <A HREF="DA_E0052.htm" TARGET="TEXT">DAMicrophone</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0060.htm" TARGET="TEXT">DASound</A> object.


<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010a00">Texture</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object by mapping the given image, as defined by <I>texture</I>, to the surfaces of the original geometry. If the geometry has no surfaces, the texture is ignored. If the original geometry already has a texture, the new texture completely overlays the original. Texture maps have no effect when applied to a geometry that lacks texture coordinates. By default, a geometry has no texture. The bounding box is the bounding box of the underlying geometry.

<P><B>geometryObj.Texture</B><B>(</B><BR>&nbsp;&nbsp;<I>image</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>image</I>
 </DT><DD>The <A HREF="DA_E0045.htm" TARGET="TEXT">DAImage</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>This attribute overrides previous values.

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010b00">Transform</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object that is the result of applying the given three-dimensional transformation to the original geometry behavior. The transformation applies to all points in the geometry, including those associated with the positions and orientations of light sources, textures, and sounds. The bounding box of a transformed geometry is the axis-aligned box enclosing the box that is the result of applying the transformation to the underlying geometry.

<P><B>geometryObj.Transform</B><B>(</B><BR>&nbsp;&nbsp;<I>xf</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>xf</I>
 </DT><DD>The <A HREF="DA_E0110.htm" TARGET="TEXT">DATransform3</A> object.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>This function composes values. The resulting transformation is the new value applied to the old value.

<H4><HR COLOR=#0000FF><A NAME="vref_000106010e010c00">Undetectable</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>Creates a new, undetectable <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object from the original geometry. An undetectable geometry means that, while the geometry is still as visible or as audible as before, any attempts to pick it are ignored. 

<P><B>geometryObj.Undetectable</B><B>(</B> <B>)</B><BR><H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A> object.


<H5>Remarks</H5>
<P>The <B>Undetectable</B> function is useful for specifying which objects are detectable and which are not. For example, suppose a semi-transparent green sphere is used to simulate a glow around an object. Because this sphere encloses the object, the object itself would be unpickable. Instead, the pick information would always be for the sphere. Tagging the sphere as unpickable allows the object itself to be picked. This attribute overrides previous values.

<H3><A NAME="vref_000106010e020000">DAGeometry Properties</A></H3>
<P><A CLASS=tctop HREF="DA_E0044.htm#vref_000106010e020100" TARGET=TEXT><IMG SRC="../art/bullet1.gif" WIDTH="5" HEIGHT="11" BORDER=0 ALT="bullet1.gif">BoundingBox</A><BR>
<H4><HR COLOR=#0000FF><A NAME="vref_000106010e020100">BoundingBox</A></H4>
<A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry Class</A>
<P>A read-only property with a <A HREF="DA_E0034.htm" TARGET="TEXT">DABbox3</A> value that creates a bounding box object defining the axis-aligned bounding box enclosing all non-transparent portions of the <I>geometryObj</I>. 

<P><B>geometryObj.BoundingBox</B><BR><H5>Return Values</H5>
<P>Returns the <A HREF="DA_E0034.htm" TARGET="TEXT">DABbox3</A> object.


<H3><A NAME="vref_000106010e030000">Relevant Functions from the DAStatics Class</A></H3>
<P>The following functions are defined in the <A HREF="DA_E0061.htm" TARGET="TEXT">DAStatics</A> class and are most relevant to objects of type <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A>.

<P><A HREF="DA_E0076.htm#vref_000106012e000100" TARGET="TEXT">lib.ImportGeometry(url)</A>
<P><A HREF="DA_E0076.htm#vref_000106012e000200" TARGET="TEXT">lib.ImportGeometryAsync(url, geoStandIn)</A>
<P><A HREF="DA_E0076.htm#vref_000106012e000300" TARGET="TEXT">lib.SoundSource(sound)</A>
<P><A HREF="DA_E0076.htm#vref_000106012e000400" TARGET="TEXT">lib.SpotLightAnim(fullcone, cutoff)</A>
<P><A HREF="DA_E0076.htm#vref_000106012e000500" TARGET="TEXT">lib.SpotLight(fullcone, cutoff)</A>
<P><A HREF="DA_E0076.htm#vref_000106012e000600" TARGET="TEXT">lib.UnionGeometry(g1, g2)</A>
<P><A HREF="DA_E0076.htm#vref_000106012e000700" TARGET="TEXT">lib.UnionGeometryArray(geoArray)</A>

<H3><A NAME="vref_000106010e040000">Relevant Properties from the DAStatics Class</A></H3>
<P>The following properties are defined in the <A HREF="DA_E0061.htm" TARGET="TEXT">DAStatics</A> class and are most relevant to objects of type <A HREF="DA_E0044.htm" TARGET="TEXT">DAGeometry</A>.

<P><A HREF="DA_E0077.htm#vref_000106012f000100" TARGET="TEXT">lib.AmbientLight</A>
<P><A HREF="DA_E0077.htm#vref_000106012f000200" TARGET="TEXT">lib.DirectionalLight</A>
<P><A HREF="DA_E0077.htm#vref_000106012f000300" TARGET="TEXT">lib.EmptyGeometry</A>
<P><A HREF="DA_E0077.htm#vref_000106012f000400" TARGET="TEXT">lib.PointLight</A>

<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
