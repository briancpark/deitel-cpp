<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IStreamSample Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0362.htm','/dssd0000.htm','/dssd0360.htm','/index.htm','/dssd0364.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="mms_face_0001080303000000">IStreamSample Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IStreamSample</B> interface provides control over the behavior of stream samples. You can retrieve the media stream that created the sample, set or retrieve sample start and stop times, check the sample's completion status, and perform a developer-specified function on the sample itself.

<A NAME="mms_face_0001080303010000"></A><P><B>When to Implement</B>
<P>Implement this interface when you implement a media stream for a new media type. The interface is exposed on sample objects created by media streams.

<A NAME="mms_face_0001080303020000"></A><P><B>When to Use</B>
<P>Use this interface when you want to control data samples




 created by <A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream</A> or its derived interfaces.

<A NAME="mms_face_0001080303030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IStreamSample methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description

</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0363.htm#mms_face_0001080303030200" TARGET="TEXT">GetMediaStream</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to the media stream object that created the current sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0363.htm#mms_face_0001080303030300" TARGET="TEXT">GetSampleTimes</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current sample's start and end times.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0363.htm#mms_face_0001080303030400" TARGET="TEXT">SetSampleTimes</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the current sample's start and end times.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0363.htm#mms_face_0001080303030500" TARGET="TEXT">Update</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Performs a synchronous or an asynchronous update on the current sample.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0363.htm#mms_face_0001080303030100" TARGET="TEXT">CompletionStatus</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the status of the current sample's latest asynchronous update. If the update isn't complete, you can force it to complete.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080303030100">IStreamSample::CompletionStatus</A></H3>
<A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample Interface</A>
<P>Retrieves the status of the current sample's latest asynchronous update. If the update isn't complete, you can force it to complete.
<P><B>HRESULT</B> <B>CompletionStatus</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwMilliseconds</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>dwFlags</I>
 </DT><DD>[in] Value that specifies whether to forcibly complete the update. This value is a combination of one or more of the following flags.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">COMPSTAT_NOUPDATEOK (0x01)
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Force the update to complete as soon as possible, even if the sample update isn't yet complete. If the sample is updating and you didn't set the COMPSTAT_WAIT flag, the method returns MS_S_PENDING. If the sample is waiting to be updated, this method removes it from the queue and returns MS_S_NOTUPDATED.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">COMPSTAT_WAIT (0x02)
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Wait until the sample finishes updating before returning from this method.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">COMPSTAT_ABORT (0x04)
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Forces the update to complete, even if it's currently updating. This leaves the sample data in an undefined state. Combine this value with the COMPSTAT_WAITFORCOMPLETION flag to ensure that the update canceled.
</FONT></TD></TR></TABLE>
</DD><DT><I>dwMilliseconds</I>
 </DT><DD>[in] If the <I>dwFlags</I> parameter is COMPSTAT_WAIT, this value is the number of milliseconds to wait for the update to complete. Specify INFINITE to indicate that you want to wait until the sample updates before returning.


</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_ABORT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The update aborted.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_S_ENDOFSTREAM
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The sample wasn't updated because it reached the end of the stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_S_NOUPDATE
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The update was forcibly completed; the sample was not updated by the stream.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_S_PENDING
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">An asynchronous update is pending.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
</FONT></TD></TR></TABLE>

<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080303030200">IStreamSample::GetMediaStream</A></H3>
<A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample Interface</A>
<P>Retrieves a pointer to the media stream object that created the current sample.
<P><B>HRESULT</B> <B>GetMediaStream</B><B>(</B><BR>&nbsp;&nbsp;<B>IMediaStream**</B> <I>ppMediaStream</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>ppMediaStream</I>
 </DT><DD>[in] Address of a pointer to an <A HREF="dssd0362.htm" TARGET="TEXT">IMediaStream</A> interface that will point to the media stream that created the current sample.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if <I>ppMediaStream</I> is invalid.

<H5>Remarks</H5>
<P>If successful, this method increments the reference count of the media stream specified by <I>ppMediaStream</I>.
<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080303030300">IStreamSample::GetSampleTimes</A></H3>
<A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample Interface</A>
<P>Retrieves the current sample's start and end times. If the sample is updating, this method returns the times after the update completes.
<P><B>HRESULT</B> <B>GetSampleTimes</B><B>(</B><BR>&nbsp;&nbsp;<B>STREAM_TIME*</B> <I>pStartTime</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TIME*</B> <I>pEndTime</I><B>,</B><BR>&nbsp;&nbsp;<B>STREAM_TIME*</B> <I>pCurrentTime</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pStartTime</I>
 </DT><DD>[out] Pointer to a <A HREF="dssd0372.htm#mm_types_000108030c000001" TARGET="TEXT">STREAM_TIME</A> value that will contain the sample's start time.
</DD><DT><I>pEndTime</I>
 </DT><DD>[out] Pointer to a <A HREF="dssd0372.htm#mm_types_000108030c000001" TARGET="TEXT">STREAM_TIME</A> value that will contain the sample's end time.
</DD><DT><I>pCurrentTime</I>
 </DT><DD>[out] Pointer to a <A HREF="dssd0372.htm#mm_types_000108030c000001" TARGET="TEXT">STREAM_TIME</A> value that will contain the media stream's current media time.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one of the parameters is invalid.

<H5>Remarks</H5>
<P>For streams that have a clock, the start and end times will be relative to the stream's current time. If the stream doesn't have a clock, the times are media-relative and the current time will be zero.
<P>The <I>pCurrentTime</I> parameter enables developers to conveniently track the media stream's current time, so you don't have to call <A HREF="dssd0361.htm#mms_face_0001080301030700" TARGET="TEXT">IMultiMediaStream::GetTime</A>. Unlike <A HREF="dssd0361.htm#mms_face_0001080301030700" TARGET="TEXT">GetTime</A>, however, this method returns S_OK if the stream doesn't have a clock; <B>GetTime</B> returns S_FALSE. The value assigned to <I>pCurrentTime</I> is the same as the value produced by the following code fragment.

<PRE><FONT FACE="Courier" SIZE="2">
pSample-&gt;GetMediaStream(&amp;pMediaStream);
pMediaStream-&gt;GetMultiMediaStream(&amp;pMultiMediaStream);
pMediaStream-&gt;Release();
pMultiMediaStream-&gt;GetTime(&amp;pCurrentTime);
pMultiMediaStream-&gt;Release();
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080303030400">IStreamSample::SetSampleTimes</A></H3>
<A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample Interface</A>
<P>Sets the current sample's start and end times. You can call this method prior to updating the sample.
<P><B>HRESULT</B> <B>SetSampleTimes</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>STREAM_TIME*</B> <I>pStartTime</I><B>,</B><BR>&nbsp;&nbsp;<B>const</B> <B>STREAM_TIME*</B> <I>pEndTime</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>pStartTime</I>
 </DT><DD>[in] Pointer to a <A HREF="dssd0372.htm#mm_types_000108030c000001" TARGET="TEXT">STREAM_TIME</A> value that contains the sample's new start time.
</DD><DT><I>pEndTime</I>
 </DT><DD>[in] Pointer to a <A HREF="dssd0372.htm#mm_types_000108030c000001" TARGET="TEXT">STREAM_TIME</A> value that contains the sample's new end time.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_POINTER if one of the parameters is NULL.

<H5>Remarks</H5>
<P>For streams that have a clock, the times must be relative to the stream's current time. If the stream doesn't have a clock, the times should be relative to the media.

<P>This method only applies to writable streams.

<H3><HR COLOR=#0000FF><A NAME="mms_face_0001080303030500">IStreamSample::Update</A></H3>
<A HREF="dssd0363.htm" TARGET="TEXT">IStreamSample Interface</A>
<P>Performs a synchronous or an asynchronous update on the current sample.
<P><B>HRESULT</B> <B>Update</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwFlags</I><B>,</B><BR>&nbsp;&nbsp;<B>HANDLE</B> <I>hEvent</I><B>,</B><BR>&nbsp;&nbsp;<B>PAPCFUNC</B> <I>pfnAPC</I><B>,</B><BR>&nbsp;&nbsp;<B>DWORD</B> <I>dwAPCData</I><BR>&nbsp;&nbsp;<B>)</B><BR><H5>Parameters</H5>
<DL><DT><I>dwFlags</I>
 </DT><DD>[in] Flag that specifies whether the update is synchronous or asynchronous. The SSUPDATE_ASYNC flag specifies an asynchronous update, which you can set if both <I>hEvent</I> and <I>pfnAPC</I> are null. Use SSUPDATE_CONTINUOUS to continuously update the sample until you call the <A HREF="dssd0363.htm#mms_face_0001080303030100" TARGET="TEXT">IStreamSample::CompletionStatus</A>



 method.



</DD><DT><I>hEvent</I>
 </DT><DD>[in] Handle to an event that this method will trigger when the update is complete.



</DD><DT><I>pfnAPC</I>
 </DT><DD>[in] Pointer to a Win32 asyncronous proceedure call (APC)




 function that this method will call after it completes the sample update.
</DD><DT><I>dwAPCData</I>
 </DT><DD>[in] Value that this method passes to the function specified by the <I>pfnAPC</I> parameter.
</DD></DL>
<H5>Return Values</H5>
<P>Returns one of the following values.
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Value </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Meaning
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_ABORT
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The update aborted.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_INVALIDARG
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One of the parameters is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">E_POINTER
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">One of the parameters is invalid.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_E_BUSY
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">This sample already has a pending update.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_S_ENDOFSTREAM
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Reached the end of the stream; the sample wasn't updated.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">MS_S_PENDING
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">The asynchronous update is pending.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">S_OK
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Success.
</FONT></TD></TR></TABLE>

<H5>Remarks</H5>
<P>This method can be used to perform a synchronous or asynchronous update of a sample. If both <I>hEvent</I> and <I>pfnAPC</I> are NULL then the update will be synchronous unless either of the SSUPDATE_ASYNC or SSUPDATE_CONTINUOUS flags is specified. When a synchronous update returns, the result of the function contains the I/O completion status.

<P>You can't specify values for both <I>hEvent</I> and <I>pfnAPC</I>; the method will fail. 




<P>Asynchronous updates might complete before the update returns; in that case, the return value is S_OK. If you specify an event and the update returns S_OK, this method sets the event on return.




 If you specify an APC function and the update returns S_OK, the APC will not be queued and the function will not be called.



<P>Asynchronous updates that don't complete prior to returning will return a value of MS_S_PENDING.

<P>Applications that create multiple streams must read from each of them to avoid having their data blocked.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
