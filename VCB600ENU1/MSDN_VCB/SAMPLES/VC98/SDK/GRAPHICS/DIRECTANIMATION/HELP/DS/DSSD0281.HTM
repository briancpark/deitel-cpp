<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Pointer Validation Macros</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0280.htm','/dssd0000.htm','/dssd0275.htm','/index.htm','/dssd0282.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="fmdebug_0001060406000000">Pointer Validation Macros</A></H2>
<BR CLEAR=ALL>
<P>Microsoft&#174; DirectShow&#153; provides some macros to make pointer usage more robust. These include a simple <A HREF="dssd0281.htm#fmdebug_0001060406000100" TARGET="TEXT">CheckPointer</A> macro (which tests if a given pointer is NULL). These also include a number of <B>ValidateXxxPtr</B> macros, which ensure a given pointer actually refers to the correct kind of memory, although possibly with a significant performance hit for each test.

<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000100" TARGET="TEXT">CheckPointer</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Checks whether or not a given pointer is NULL.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000200" TARGET="TEXT">ValidateReadPtr</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Validates a read pointer.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000300" TARGET="TEXT">ValidateReadWritePtr</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Validates a read/write pointer.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000400" TARGET="TEXT">ValidateStringPtr</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Validates a string pointer.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000500" TARGET="TEXT">ValidateStringPtrA</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Validates an ANSI string pointer.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000600" TARGET="TEXT">ValidateStringPtrW</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Validates a wide (Unicode) string pointer.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0281.htm#fmdebug_0001060406000700" TARGET="TEXT">ValidateWritePtr</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Validates a write pointer.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000100">CheckPointer</A></H3>
<P>Determines if a given pointer is NULL. If the pointer is NULL, <B>CheckPointer</B> returns a user-defined value.

<P><B>CheckPointer</B><B>(</B><BR>&nbsp;&nbsp;<I>p</I><B>,</B><BR>&nbsp;&nbsp;<I>ret</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>Pointer to check.
</DD><DT><I>ret</I>
 </DT><DD>Value your function will return if <I>p</I> is NULL.
</DD></DL>
<H5>Remarks</H5>
<P>The following examples illustrate how to call this macro.

<PRE><FONT FACE="Courier" SIZE="2">
HRESULT OneFunction(VOID *pSomeParameter)
{
    CheckPointer(pSomeParameter, E_INVALIDARG)
}

BOOL AnotherFunction(VOID *pSomeParameter)
{
    CheckPointer(pSomeParameter, FALSE)
}
</FONT></PRE>
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000200">ValidateReadPtr</A></H3>
<P>Checks a read pointer. If the pointer is not valid, this macro calls 
<A HREF="dssd0278.htm#fmdebug_0001060403000100" TARGET="TEXT">DbgBreak</A>.
<P><B>ValidateReadPtr</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>void</B> <B>*</B> <I>p</I><B>,</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>cb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>Pointer value (of any type).
</DD><DT><I>cb</I>
 </DT><DD>Byte count to be checked.
</DD></DL>
<H5>Remarks</H5>
<P>This macro is ignored unless <A HREF="dssd0388.htm#reserved_00010a0108000001" TARGET="TEXT">DEBUG</A> or <A HREF="dssd0388.htm#reserved_00010a0108000003" TARGET="TEXT">VFWROBUST</A> is defined when the Microsoft DirectShow headers are included.
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000300">ValidateReadWritePtr</A></H3>
<P>Checks a read/write pointer. If the pointer is not valid, this macro calls <A HREF="dssd0278.htm#fmdebug_0001060403000100" TARGET="TEXT">DbgBreak</A>.
<P><B>ValidateReadWritePtr</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>void</B> <B>*</B> <I>p</I><B>,</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>cb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>Pointer value (of any type).
</DD><DT><I>cb</I>
 </DT><DD>Byte count to be checked.
</DD></DL>
<H5>Remarks</H5>
<P>This macro is ignored unless <A HREF="dssd0388.htm#reserved_00010a0108000001" TARGET="TEXT">DEBUG</A> or <A HREF="dssd0388.htm#reserved_00010a0108000003" TARGET="TEXT">VFWROBUST</A> is defined when the Microsoft DirectShow headers are included.
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000400">ValidateStringPtr</A></H3>
<P>Checks a string pointer and calls <A HREF="dssd0278.htm#fmdebug_0001060403000100" TARGET="TEXT">DbgBreak</A> if the pointer is not valid.
<P><B>ValidateStringPtr</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCTSTR</B> <I>p</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>TCHAR string pointer value.
</DD></DL>
<H5>Remarks</H5>
<P>This macro is ignored unless <A HREF="dssd0388.htm#reserved_00010a0108000001" TARGET="TEXT">DEBUG</A> or <A HREF="dssd0388.htm#reserved_00010a0108000003" TARGET="TEXT">VFWROBUST</A>
is defined when the Microsoft DirectShow headers are included.
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000500">ValidateStringPtrA</A></H3>
<P>Checks an ANSI string pointer and calls <A HREF="dssd0278.htm#fmdebug_0001060403000100" TARGET="TEXT">DbgBreak</A> if the pointer is not valid.
<P><B>ValidateStringPtrA</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCSTR</B> <I>p</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>ANSI string pointer value.
</DD></DL>
<H5>Remarks</H5>
<P>This macro is ignored unless <A HREF="dssd0388.htm#reserved_00010a0108000001" TARGET="TEXT">DEBUG</A> or <A HREF="dssd0388.htm#reserved_00010a0108000003" TARGET="TEXT">VFWROBUST</A>
is defined when the Microsoft DirectShow headers are included.
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000600">ValidateStringPtrW</A></H3>
<P>Checks a wide (Unicode) string pointer and calls <A HREF="dssd0278.htm#fmdebug_0001060403000100" TARGET="TEXT">DbgBreak</A> if the pointer is not valid.
<P><B>ValidateStringPtrW</B><B>(</B><BR>&nbsp;&nbsp;<B>LPCWSTR</B> <I>p</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>Wide string pointer value.
</DD></DL>
<H5>Remarks</H5>
<P>This macro is ignored unless <A HREF="dssd0388.htm#reserved_00010a0108000001" TARGET="TEXT">DEBUG</A> or <A HREF="dssd0388.htm#reserved_00010a0108000003" TARGET="TEXT">VFWROBUST</A>
is defined when the Microsoft DirectShow headers are included.
<H3><HR COLOR=#0000FF><A NAME="fmdebug_0001060406000700">ValidateWritePtr</A></H3>
<P>Checks a write pointer and calls <A HREF="dssd0278.htm#fmdebug_0001060403000100" TARGET="TEXT">DbgBreak</A> if the pointer is not valid.
<P><B>ValidateWritePtr</B><B>(</B><BR>&nbsp;&nbsp;<B>const</B> <B>void</B> <B>*</B> <I>p</I><B>,</B><BR>&nbsp;&nbsp;<B>UINT</B> <I>cb</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>p</I>
 </DT><DD>Pointer value (of any type).
</DD><DT><I>cb</I>
 </DT><DD>Byte count to be checked.
</DD></DL>
<H5>Remarks</H5>
<P>This macro is ignored unless <A HREF="dssd0388.htm#reserved_00010a0108000001" TARGET="TEXT">DEBUG</A> or <A HREF="dssd0388.htm#reserved_00010a0108000003" TARGET="TEXT">VFWROBUST</A>
is defined when the Microsoft DirectShow headers are included.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
