<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IAMVideoCompression Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0112.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0114.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_0001060119000000">IAMVideoCompression Interface</A></H2>
<BR CLEAR=ALL>
<P>The <B>IAMVideoCompression</B> pin interface enables you to control compression parameters that aren't part of the media type.


<P>The <A HREF="dssd0113.htm#If_0001060119030900" TARGET="TEXT">put_PFramesPerKeyFrame</A> and 
<A HREF="dssd0113.htm#If_0001060119030400" TARGET="TEXT">get_PFramesPerKeyFrame</A> methods refer to predicted (P) frames and bidirectional (B) frames, which are MPEG concepts and not generally applicable to simpler types of compressors.






<A NAME="If_0001060119010000"></A><P><B>When to Implement</B>
<P>Implement this interface on the output pin of a video capture or video compressor filter that provides compressed video data. 

<A NAME="If_0001060119020000"></A><P><B>When to Use</B>
<P>An application can use this interface to control how video is compressed, including characteristics such as the number of key frames and frame quality. Use it to retrieve a textual description of the compressor and other available information, including the compressor's capabilities.

<A NAME="If_0001060119030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IAMVideoCompression methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030800" TARGET="TEXT">put_KeyFrameRate</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the key frame rate.


</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030300" TARGET="TEXT">get_KeyFrameRate</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the key frame rate.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030900" TARGET="TEXT">put_PFramesPerKeyFrame</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the predicted (P) frame frequency.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030400" TARGET="TEXT">get_PFramesPerKeyFrame</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the P frame frequency.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030a00" TARGET="TEXT">put_Quality</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the quality of the video image compression.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030500" TARGET="TEXT">get_Quality</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the current image quality setting.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030b00" TARGET="TEXT">put_WindowSize</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Sets the number of frames over which the compressor must maintain an average data rate.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030200" TARGET="TEXT">get_WindowSize</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the number of frames over which the compressor must maintain an average data rate.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">GetInfo</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves compressor information.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030700" TARGET="TEXT">OverrideKeyFrame</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Forces a particular frame to be a key frame.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0113.htm#If_0001060119030600" TARGET="TEXT">OverrideFrameSize</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Overrides a particular frame's data rate.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_0001060119030100">IAMVideoCompression::GetInfo</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Retrieves compressor information.

<P><B>HRESULT</B> <B>GetInfo</B><B>(</B><BR>&nbsp;&nbsp;<B>WCHAR</B> <B>*</B> <I>pszVersion</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>*pcbVersion</I><B>,</B><BR>&nbsp;&nbsp;<B>LPWSTR</B> <I>pszDescription</I><B>,</B><BR>&nbsp;&nbsp;<B>int</B> <I>*pcbDescription</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDefaultKeyFrameRate</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pDefaultPFramesPerKey</I><B>,</B><BR>&nbsp;&nbsp;<B>double</B> <I>*pDefaultQuality</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>*pCapabilities</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pszVersion</I>
</DT><DD>[out] Pointer to a version string, such as "Version 2.1.0".
</DD><DT><I>pcbVersion</I>
</DT><DD>[in,out] Size needed for a version string. Pointer to the number of bytes in the Unicode string, not the number of characters, so it must be twice the number of characters the string can hold. Call with this set to NULL to retrieve the current size.
</DD><DT><I>pszDescription</I>
</DT><DD>[out] Pointer to a description string, such as "Awesome Video Compressor". 
</DD><DT><I>pcbDescription</I>
</DT><DD>[in,out] Size needed for a description string. Pointer to the number of bytes in the Unicode string, not the number of characters, so it must be twice the number of characters the string can hold. Call with this set to NULL to retrieve the current size.
</DD><DT><I>pDefaultKeyFrameRate</I>
</DT><DD>[out] Pointer to receive the default key frame rate.
</DD><DT><I>pDefaultPFramesPerKey</I>
</DT><DD>[out] Pointer to receive the default predicted (P) frames per key frame.
</DD><DT><I>pDefaultQuality</I>
</DT><DD>[out] Pointer to receive the default quality.
</DD><DT><I>pCapabilities</I>
</DT><DD>[out] Pointer to receive the compression capabilities, which are a combination of the <A HREF="dssd0288.htm#dtypes_0001060601001000" TARGET="TEXT">CompressionCaps</A> data type flags.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 

<H3><HR COLOR=#0000FF><A NAME="If_0001060119030200">IAMVideoCompression::get_WindowSize</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Retrieves the number of frames over which the compressor must maintain an average data rate.

<P><B>HRESULT</B> <B>get_WindowSize</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORDLONG</B> <B>*</B> <I>pWindowSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pWindowSize</I>
</DT><DD>[out] Pointer to a DWORDLONG value that will receive the window size.


</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 


<H5>See Also</H5>
<P><A HREF="dssd0113.htm#If_0001060119030b00" TARGET="TEXT">IAMVideoCompression::put_WindowSize</A><H3><HR COLOR=#0000FF><A NAME="If_0001060119030300">IAMVideoCompression::get_KeyFrameRate</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Retrieves the current key frame rate.

<P><B>get_KeyFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>pKeyFrameRate</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pKeyFrameRate</I>
</DT><DD>[out] Compressor's current key frame rate. A negative value means it is using the default frame rate for the video compressor. A zero value means only the first frame is a key frame.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 



<H5>Remarks</H5>
<P>To determine if the compressor supports this method, check for the <A HREF="dssd0288.htm#dtypes_0001060601001003" TARGET="TEXT">CompressionCaps_CanKeyFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method.
 
<H5>See Also</H5>
<P>IAMVideoCompression::put_KeyFrameRate<H3><HR COLOR=#0000FF><A NAME="If_0001060119030400">IAMVideoCompression::get_PFramesPerKeyFrame</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Retrieves the predicted (P) frame interval.

<P><B>HRESULT</B> <B>get_PFramesPerKeyFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <B>*</B> <I>pPFramesPerKeyFrame</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pPFramesPerKeyFrame</I>
</DT><DD>[out] Pointer to receive the number of P frames per key frame. A negative value means the compressor will use its default value.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="dssd0342.htm#filteref_0001070130000000" TARGET="TEXT">VFW Video Capture</A>) and the AVI compression filter (<A HREF="dssd0300.htm#filteref_0001070106000000" TARGET="TEXT">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL.


<H5>Remarks</H5>
<P>To determine if the compressor supports this method,
check for the <A HREF="dssd0288.htm#dtypes_0001060601001004" TARGET="TEXT">CompressionCaps_CanBFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method.

<P>As an example of the relationship between the types of frames, suppose a key frame occurs once in every 10 frames, and there are 3 P frames per key frame. The P frames will be spaced evenly between the key frames. The other 6 frames, which occur between the key frames and the P frames, will be bidirectional (B) frames.


 
<H5>See Also</H5>
<P>IAMVideoCompression::put_KeyFrameRate<H3><HR COLOR=#0000FF><A NAME="If_0001060119030500">IAMVideoCompression::get_Quality</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Retrieves the current image quality setting.

<P><B>HRESULT</B> <B>get_Quality</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <B>*</B> <I>pQuality</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>pQuality</I>
</DT><DD>[out] Current quality setting.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface.
<H5>Remarks</H5>
<P>The quality is a value between 0 and 1. One indicates the highest (best) quality and 0 indicates the lowest (worst) quality. A negative number means it is using the compressor default. The compressor interprets this number; this interpretation varies from compressor to compressor. When the compressor is not compressing to a specific data rate, the value will roughly determine the image size or quality.

<P>To determine if the compressor supports this method, check for the <A HREF="dssd0288.htm#dtypes_0001060601001001" TARGET="TEXT">CompressionCaps_CanQuality</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method.

<P>If you are compressing to a fixed data rate, a high quality value means use all of the data rate, and a low quality value means you can use much lower than the data rate.
 

<H3><HR COLOR=#0000FF><A NAME="If_0001060119030600">IAMVideoCompression::OverrideFrameSize</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Overrides a frame's data rate.

<P><B>HRESULT</B> <B>OverrideFrameSize</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>FrameNumber</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>Size</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>FrameNumber</I>
</DT><DD>[in] Frame number for which to change the size.
</DD><DT><I>Size</I>
</DT><DD>[in] Desired size, in bytes, for the specified frame.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="dssd0342.htm#filteref_0001070130000000" TARGET="TEXT">VFW Video Capture</A>) and the AVI compression filter (<A HREF="dssd0300.htm#filteref_0001070106000000" TARGET="TEXT">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL.


<H5>Remarks</H5>
<P>To determine if the compressor might support this method, check for the <A HREF="dssd0288.htm#dtypes_0001060601001002" TARGET="TEXT">CompressionCaps_CanCrunch</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method. The flag might also be set to indicate that the 
<A HREF="dssd0287.htm#structs_0001060501001e03" TARGET="TEXT">dwBitRate</A> value can be set in the <A HREF="dssd0287.htm#structs_0001060501000300" TARGET="TEXT">AM_MEDIA_TYPE</A>'s <A HREF="dssd0287.htm#structs_0001060501001e00" TARGET="TEXT">VIDEOINFOHEADER</A> structure.

<P>The frame number refers to which frame goes out of the filter after it is streaming. For example, frame 0 means the first frame this pin delivers. Frame 11 means the twelfth frame it delivers. Be sure to call this method before the filter delivers the frame for which you want to provide a different size.

<P>Overriding the frame size (or "crunching" the frame) instructs the filter to make the frame size this many bytes or less instead of the originally planned size.
 

<H3><HR COLOR=#0000FF><A NAME="If_0001060119030700">IAMVideoCompression::OverrideKeyFrame</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Forces a frame to be a key frame.

<P><B>HRESULT</B> <B>OverrideKeyFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>FrameNumber</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>FrameNumber</I>
</DT><DD>[in] Number of the frame to be made a key frame when the graph runs, even if it wouldn't usually be a key frame.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="dssd0342.htm#filteref_0001070130000000" TARGET="TEXT">VFW Video Capture</A>) and the AVI compression filter (<A HREF="dssd0300.htm#filteref_0001070106000000" TARGET="TEXT">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL. 


<H5>Remarks</H5>
<P>Once a compressor creates a key frame, it might reset its count to determine when the next key frame should occur. For example, assume a key frame typically occurs once every 10 frames. If you mark frame 5 as a key frame using <B>OverrideKeyFrame</B>, the compressor might wait 10 more frames until creating the next key frame. 
<H3><HR COLOR=#0000FF><A NAME="If_0001060119030800">IAMVideoCompression::put_KeyFrameRate</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Sets the key frame rate. 

<P><B>HRESULT</B> <B>put_KeyFrameRate</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>KeyFrameRate</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>KeyFrameRate</I>
</DT><DD>[in] Desired key frame rate. A negative value means use the default frame rate for the video compressor. A zero value means that only the first frame is a key frame.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 
<H5>Remarks</H5>
<P>To determine if the compressor supports this method, check for the <A HREF="dssd0288.htm#dtypes_0001060601001003" TARGET="TEXT">CompressionCaps_CanKeyFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method.
 

<H3><HR COLOR=#0000FF><A NAME="If_0001060119030900">IAMVideoCompression::put_PFramesPerKeyFrame</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Sets predicted (P) frame interval.

<P><B>HRESULT</B> <B>put_PFramesPerKeyFrame</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>PFramesPerKeyFrame</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>PFramesPerKeyFrame</I>
</DT><DD>[in] Desired P frame interval. A negative value means use the default frame rate for the video compressor. 
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The Video for Windows capture filter (<A HREF="dssd0342.htm#filteref_0001070130000000" TARGET="TEXT">VFW Video Capture</A>) and the AVI compression filter (<A HREF="dssd0300.htm#filteref_0001070106000000" TARGET="TEXT">AVI Compressor</A>) do not currently support this interface and return E_NOTIMPL. 


<H5>Remarks</H5>
<P>To determine if the compressor supports this method, check for the <A HREF="dssd0288.htm#dtypes_0001060601001004" TARGET="TEXT">CompressionCaps_CanBFrame</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method.

<P>As an example of the relationship between the types of frames, suppose a key frame occurs once in every 10 frames, and there are 3 P frames per key frame. The P frames will be spaced evenly between the key frames. The other 6 frames, which occur between the key frames and the P frames, will be bidirectional (B) frames.


 
<H3><HR COLOR=#0000FF><A NAME="If_0001060119030a00">IAMVideoCompression::put_Quality</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Sets the quality of the video image.

<P><B>HRESULT</B> <B>put_Quality</B><B>(</B><BR>&nbsp;&nbsp;<B>double</B> <I>Quality</I><BR>&nbsp;&nbsp;<B>)</B> <B>PURE;</B> <BR><H5>Parameters</H5>
<DL><DT><I>Quality</I>
</DT><DD>[in] Desired quality.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 
<H5>Remarks</H5>
<P>The quality is a value between 0 and 1, inclusive. One indicates the highest (best) quality and 0 indicates the lowest (worst) quality. A negative number means use the compressor default. The compressor (codec) interprets this number; interpretation varies from codec to codec. When the compressor is not compressing to a specific data rate, the value will roughly determine the image size or quality.

<P>To determine if the compressor supports this method, check the <A HREF="dssd0288.htm#dtypes_0001060601001001" TARGET="TEXT">CompressionCaps_CanQuality</A> flag returned in the <I>pCapabilities</I> parameter of the <A HREF="dssd0113.htm#If_0001060119030100" TARGET="TEXT">IAMVideoCompression::GetInfo</A> method.

<P>If you are compressing to a fixed data rate, a high quality value means use all of the data rate, and a low quality value means you can use much lower than the data rate.
<H3><HR COLOR=#0000FF><A NAME="If_0001060119030b00">IAMVideoCompression::put_WindowSize</A></H3>
<A HREF="dssd0113.htm" TARGET="TEXT">IAMVideoCompression Interface</A>
<P>Sets the number of frames over which the compressor must maintain an average data rate.

<P><B>HRESULT</B> <B>put_WindowSize</B><B>(</B><BR>&nbsp;&nbsp;<B>DWORDLONG</B> <I>WindowSize</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>WindowSize</I>
</DT><DD>[in] Window size, or number of frames, whose average size cannot exceed the data rate that the compressor has been asked to provide.


</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. 



<H5>Remarks</H5>
<P>For a window of size <I>n</I>, the average frame size of any consecutive <I>n</I> frames will not exceed the stream's specified data rate, although individual frames can be larger or smaller. For example, if you have set a data rate of 100 kilobytes (KB) per second
 on a 10 frames per second (fps) movie, that will usually mean each frame must be less than or equal to 10 KB.

 However, by setting a window size of <I>n</I>, you are specifying that as long as the average length of those <I>n</I> frames is less than or equal to 10 KB, it doesn't matter how large the individual frames are. For example, some could be smaller and some could actually be larger than 10 KB, as long as the average is less than or equal to 10 KB.

<H5>See Also</H5>
<P><A HREF="dssd0113.htm#If_0001060119030200" TARGET="TEXT">IAMVideoCompression::get_WindowSize</A><P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
