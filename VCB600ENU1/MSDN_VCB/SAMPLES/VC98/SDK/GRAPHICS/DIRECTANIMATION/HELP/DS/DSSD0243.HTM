<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>CSource Class</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0242.htm','/dssd0000.htm','/dssd0180.htm','/index.htm','/dssd0244.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="Lib_000106023f000000">CSource Class</A></H2>
<BR CLEAR=ALL>
<P><IMG SRC="art/source01.gif" WIDTH="299" HEIGHT="229" ALT="CSource class hierarchy" >





<P>This class and its corresponding class, <A HREF="dssd0245.htm" TARGET="TEXT">CSourceStream</A>, simplify the construction
of source filters that produce continuous streams of data comparable to the way the
<A HREF="dssd0247.htm" TARGET="TEXT">CTransformFilter</A> class assists in the creation of transform filters.

<P>The <B>CSource</B> class provides a wrapper for the <A HREF="dssd0194.htm" TARGET="TEXT">CBaseFilter</A> class that
performs the pin management and works with the <A HREF="dssd0245.htm" TARGET="TEXT">CSourceStream</A> class to provide the pins.

<P>To use the <B>CSource</B> class to build a filter:
<UL><LI>Derive your filter-level class from the <B>CSource</B> class. Provide a <B>CreateInstance</B> member function in it to create a new object of the class.
 <LI>Provide a means of adding objects that are derived from the <A HREF="dssd0245.htm" TARGET="TEXT">CSourceStream</A> class to support the output pins during construction of the class. You can either create them yourself during construction or provide the developer with a means of creating them later.
</UL>
<P>For an example of using the <B>CSource</B> class, see the Ball sample in the
\Samples\DS\Ball directory of the Microsoft&#174; DirectShow&#153; SDK Software Development Kit (SDK).


<P>This class does not help build an asynchronous file reader source filter, which
requires support of an <A HREF="dssd0114.htm" TARGET="TEXT">IAsyncReader</A> interface and a downstream parser filter
that supports the <A HREF="dssd0237.htm" TARGET="TEXT">CPullPin</A> class. 


<A NAME="Lib_000106023f010000"></A><P><B>Protected Data Members</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="Lib_000106023f010001">m_cStateLock</A></B> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Locks this data member to serialize access to the filter state.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="Lib_000106023f010002">m_iPins</A></B> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Number of pins on this filter; updated by the <A HREF="dssd0243.htm#Lib_000106023f030200" TARGET="TEXT">CSource::AddPin</A> and <A HREF="dssd0243.htm#Lib_000106023f030700" TARGET="TEXT">CSource::RemovePin</A> member functions.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B><A NAME="Lib_000106023f010003">m_paStreams</A></B> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Array of streams associated with this filter.
</FONT></TD></TR></TABLE>
<A NAME="Lib_000106023f020000"></A><P><B>Member Functions</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030200" TARGET="TEXT">AddPin</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Adds a pin to the source filter.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030100" TARGET="TEXT">CSource</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Constructs a <A HREF="dssd0243.htm" TARGET="TEXT">CSource</A> object.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030300" TARGET="TEXT">FindPinNumber</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the number of the pin
through the <I>IPin</I> parameter.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030400" TARGET="TEXT">GetPin</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns a pointer to a specified pin.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030500" TARGET="TEXT">GetPinCount</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Gets the number of pins contained by the filter.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030600" TARGET="TEXT">pStateLock</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns a pointer to the filter-critical section.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0243.htm#Lib_000106023f030700" TARGET="TEXT">RemovePin</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Removes a pin from the source filter.
</FONT></TD></TR></TABLE>
<A NAME="Lib_000106023f030000"></A><P><B>Implemented IBaseFilter Methods</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Name </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0116.htm#If_000106011c030200" TARGET="TEXT">FindPin</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a pointer to the pin with the
specified identifier.
</FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030100">CSource::CSource</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Initializes the <A HREF="dssd0243.htm" TARGET="TEXT">CSource</A> object.



<P><B>CSource</B><B>(</B><BR>&nbsp;&nbsp;<B>TCHAR</B> <I>*pName</I><B>,</B><BR>&nbsp;&nbsp;<B>LPUNKNOWN</B> <I>lpunk</I><B>,</B><BR>&nbsp;&nbsp;<B>CLSID</B> <I>clsid</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pName</I>
</DT><DD>Debugging name of this object.
</DD><DT><I>lpunk</I>
</DT><DD>Controlling <A HREF="dssd0175.htm" TARGET="TEXT">IUnknown</A> passed to the derived class's <B>CreateInstance</B> function.
</DD><DT><I>clsid</I>
</DT><DD>Class identifier of the filters.
</DD></DL>
<H5>Return Values</H5>
<P>No return value.
<H5>Remarks</H5>
<P>The derived class could create the pins here, unless it provides a means for the developer to
do this.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030200">CSource::AddPin</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Adds a pin to the source filter.

<P><B>HRESULT</B> <B>AddPin</B><B>(</B><BR>&nbsp;&nbsp;<B>CSourceStream</B> <B>*</B> <I>pStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pStream</I>
</DT><DD>Pointer to the <A HREF="dssd0245.htm" TARGET="TEXT">CSourceStream</A> object associated with the pin.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful, or E_OUTOFMEMORY if no memory is available.


<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030300">CSource::FindPinNumber</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Retrieves the number of the pin supporting a given <A HREF="dssd0165.htm" TARGET="TEXT">IPin</A> interface.

<P><B>int</B> <B>FindPinNumber</B><B>(</B><BR>&nbsp;&nbsp;<B>IPin</B> <I>*iPin</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>iPin</I>
</DT><DD><A HREF="dssd0165.htm" TARGET="TEXT">IPin</A> interface of the pin to retrieve.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the pin number or &#150;1 if no matching pin number is found.


<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030400">CSource::GetPin</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Returns a pointer to the specified pin. 

<P><B>CBasePin</B> <B>*GetPin</B><B>(</B><BR>&nbsp;&nbsp;<B>int</B> <I>n</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>n</I>
</DT><DD>Pin number of the requested pin.
</DD></DL>
<H5>Return Values</H5>
<P>Returns the pointer to the pin or NULL if the index is out of range.


<H5>Remarks</H5>
<P>This member function is specified in <A HREF="dssd0194.htm" TARGET="TEXT">CBaseFilter</A> and is implemented here.
Note that this pin interface will not have been reference counted when obtained.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030500">CSource::GetPinCount</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Retrieves the number of pins contained by the filter.

<P><B>int</B> <B>GetPinCount</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the pin count.


<H5>Remarks</H5>
<P>This member function is specified in <A HREF="dssd0194.htm" TARGET="TEXT">CBaseFilter</A> and is implemented here.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030600">CSource::pStateLock</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Retrieves a pointer to the filter-critical section.

<P><B>CCritSec*</B> <B>pStateLock</B><B>(</B><B>void</B><B>)</B><B>;</B><BR><H5>Return Values</H5>
<P>Returns the critical section.


<H5>Remarks</H5>
<P>Locking consists of holding the filter-critical section by calling the 
<B>pStateLock</B> member function and using the returned object to serialize
access to functions. Typically, this lock can be held by a function when
the worker thread might want to hold it. Therefore, to access a shared state from the worker thread,
add another critical-section object. The exception occurs during the processing loop of the thread
when it is safe to retrieve the filter-critical section from within <A HREF="dssd0245.htm#Lib_0001060241030700" TARGET="TEXT">CSourceStream::FillBuffer</A>.
<H3><HR COLOR=#0000FF><A NAME="Lib_000106023f030700">CSource::RemovePin</A></H3>
<A HREF="dssd0243.htm" TARGET="TEXT">CSource Class</A>
<P>Removes a pin from the source filter.

<P><B>HRESULT</B> <B>RemovePin</B><B>(</B><BR>&nbsp;&nbsp;<B>CSourceStream</B> <B>*</B> <I>pStream</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>pStream</I>
</DT><DD><A HREF="dssd0245.htm" TARGET="TEXT">CSourceStream</A> object associated with the pin.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or S_FALSE if unsuccessful.


<H5>Remarks</H5>
<P>The <I>pStream</I> parameter is not deleted. This member function adjusts pin locations in
the <A HREF="dssd0243.htm#Lib_000106023f010003" TARGET="TEXT">m_paStreams</A> array.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
