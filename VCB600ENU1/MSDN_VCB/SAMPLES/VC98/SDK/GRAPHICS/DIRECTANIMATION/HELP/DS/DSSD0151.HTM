<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>IMediaEventEx Interface</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0150.htm','/dssd0000.htm','/dssd0088.htm','/index.htm','/dssd0152.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="If_000106013f000000">IMediaEventEx Interface</A></H2>
<BR CLEAR=ALL>
<P>This interface derives from <A HREF="dssd0150.htm" TARGET="TEXT">IMediaEvent</A> and adds a method 
that allows registration of a window to receive messages when events occur. 


<A NAME="If_000106013f010000"></A><P><B>When to Implement</B>
<P>This interface is implemented by the filter graph manager.

<P>Unlike <A HREF="dssd0150.htm" TARGET="TEXT">IMediaEvent</A>, <A HREF="dssd0151.htm" TARGET="TEXT">IMediaEventEx</A> is not available through 
Automation, and therefore cannot be called directly from Visual Basic. 

<P>The <A HREF="dssd0226.htm#Lib_000106022e000000" TARGET="TEXT">CMediaEvent Class</A> supports <A HREF="dssd0151.htm" TARGET="TEXT">IMediaEventEx</A>.

<A NAME="If_000106013f020000"></A><P><B>When to Use</B>
<P>This interface is used by applications to receive notification that
an event has occurred. Applications can then avoid using a separate thread 
that waits until an event is set.

<P>For a list of system-defined event notifications, see
<A HREF="dssd0291.htm#events_0001060801000000" TARGET="TEXT">DirectShow Event Notification Codes</A>.

<A NAME="If_000106013f030000"></A><P><B>Methods in Vtable Order</B>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IUnknown methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Returns pointers to supported interfaces.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030100" TARGET="TEXT">AddRef</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Increments the reference count.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0175.htm#If_0001060157030300" TARGET="TEXT">Release</A> </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Decrements the reference count.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IDispatch methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000080" TARGET="TEXT">GetTypeInfoCount</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Determines whether there is type information available for this dispinterface.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900007f" TARGET="TEXT">GetTypeInfo</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the type information for this dispinterface if
 <A HREF="dssd0389.htm#external_00010a0109000080" TARGET="TEXT">GetTypeInfoCount</A> returned
successfully.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a010900007e" TARGET="TEXT">GetIDsOfNames</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Converts text names of properties and methods (including arguments) to
their corresponding DISPIDs.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0389.htm#external_00010a0109000081" TARGET="TEXT">Invoke</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Calls a method or accesses a property in this dispinterface if given a DISPID
and any other necessary parameters.
</FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaEvent methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0150.htm#If_000106013e030400" TARGET="TEXT">GetEventHandle</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves a handle to a manual-reset event that will be signaled.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0150.htm#If_000106013e030300" TARGET="TEXT">GetEvent</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves the next notification event.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0150.htm#If_000106013e030600" TARGET="TEXT">WaitForCompletion</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Waits until the graph's operation has completed.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0150.htm#If_000106013e030100" TARGET="TEXT">CancelDefaultHandling</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Cancels any default handling of the specified event by the filter graph.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0150.htm#If_000106013e030500" TARGET="TEXT">RestoreDefaultHandling</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Restores default handling for this event.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0150.htm#If_000106013e030200" TARGET="TEXT">FreeEventParams</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Frees resources associated with the parameters to an event.
 </FONT></TD></TR></TABLE>
<TABLE BORDER=0>
<TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>IMediaEventEx methods </B></FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><B>Description
</B></FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0151.htm#If_000106013f030300" TARGET="TEXT">SetNotifyWindow</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Registers a window that will handle messages when a specified event occurs.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0151.htm#If_000106013f030200" TARGET="TEXT">SetNotifyFlags</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Turns event notifications on or off.
</FONT></TD></TR><TR><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2"><A HREF="dssd0151.htm#If_000106013f030100" TARGET="TEXT">GetNotifyFlags</A>
 </FONT></TD><TD ALIGN=LEFT VALIGN=TOP><FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">Retrieves whether event notifications are on or off.
 </FONT></TD></TR></TABLE>
<H3><HR COLOR=#0000FF><A NAME="If_000106013f030100">IMediaEventEx::GetNotifyFlags</A></H3>
<A HREF="dssd0151.htm" TARGET="TEXT">IMediaEventEx Interface</A>
<P>Retrieves whether event notifications are on or off. 
<P><B>HRESULT</B> <B>GetNotifyFlags</B><B>(</B><BR>&nbsp;&nbsp;<B>[out]</B> <B>long</B> <I>*lplNoNotifyFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>lplNoNotifyFlags</I>
 </DT><DD>[out] Pointer to a value indicating whether event notifications should be on or off. 0x00 indicates notifications are on and 0x01 indicates notifications are off.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns S_OK if successful or E_POINTER if <I>lplNoNotifyFlags</I> is NULL.

<H5>Remarks</H5>
<P>The handle returned by the <A HREF="dssd0150.htm#If_000106013e030400" TARGET="TEXT">GetEventHandle</A> method will be signaled at end of stream.


<H3><HR COLOR=#0000FF><A NAME="If_000106013f030200">IMediaEventEx::SetNotifyFlags</A></H3>
<A HREF="dssd0151.htm" TARGET="TEXT">IMediaEventEx Interface</A>
<P>Turns event notifications on or off.
<P><B>HRESULT</B> <B>SetNotifyFlags</B><B>(</B><BR>&nbsp;&nbsp;<B>long</B> <I>lNoNotifyFlags</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B> <BR><H5>Parameters</H5>
<DL><DT><I>lNoNotifyFlags</I>
 </DT><DD>[in] Value indicating whether event notifications should be on or off. Specify 0x00 to turn notifications on or specify 0x01 to turn notification off.
</DD></DL>
<H5>Return Values</H5>
<P>Returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> value that depends on the implementation of the interface. The current DirectShow implementation returns S_OK if successful or E_INVALIDARG if the argument is invalid.

<H5>Remarks</H5>
<P>If notification has been turned off, the handle returned by the <A HREF="dssd0150.htm#If_000106013e030400" TARGET="TEXT">GetEventHandle</A> method will be signaled at end of stream.
<H3><HR COLOR=#0000FF><A NAME="If_000106013f030300">IMediaEventEx::SetNotifyWindow</A></H3>
<A HREF="dssd0151.htm" TARGET="TEXT">IMediaEventEx Interface</A>
<P>Registers a window that will handle messages in response to all
events from an object.

<P><B>HRESULT</B> <B>SetNotifyWindow</B><B>(</B><BR>&nbsp;&nbsp;<B>OAHWND</B> <I>hwnd</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>lMsg</I><B>,</B><BR>&nbsp;&nbsp;<B>long</B> <I>lInstanceData</I><BR>&nbsp;&nbsp;<B>)</B><B>;</B><BR><H5>Parameters</H5>
<DL><DT><I>hwnd</I>
 </DT><DD>[in] Handle of window to notify. Pass NULL to stop notification.
</DD><DT><I>lMsg</I>
 </DT><DD>[in] The window message to be passed as the notification.

</DD><DT><I>lInstanceData</I>
 </DT><DD>[in] Value (instance data) to be passed as the <I>lParam</I> 
 parameter for the <I>lMsg</I> message.
</DD></DL>
<H5>Return Values</H5>
<P>Returns S_OK if successful or E_INVALIDARG if an argument is invalid.


<H5>Remarks</H5>
<P>This method designates a window as the recipient of messages generated by or sent 
to the current DirectShow object. You can use 
this method to monitor the messages from multiple sources in a single window, which lowers 
processing overhead.

<P>If an event occurs, DirectShow posts the notification message specified in <I>lMsg</I> 
to the window specified by <I>hwnd</I>. <B>SetNotifyWindow</B> sets the message's 
<I>lParam</I> parameter to <I>lInstanceData</I> and its <I>wParam</I> parameter to zero.

<P>You can retrieve the event information by calling the <A HREF="dssd0150.htm#If_000106013e030300" TARGET="TEXT">GetEvent</A>
 method when the destination window receives the message.

<P>All event types post the message; when it arrives, any number of events, including zero, 
might actually be in the queue. If more than one event is in the queue when you call 
<B>SetNotifyWindow</B>, DirectShow posts only one message. If the application can receive the message after some other action has cleared events from the queue, there might be no events in the queue. For example, the
<A HREF="dssd0149.htm#If_000106013d030800" TARGET="TEXT">Stop</A> method clears all <A HREF="dssd0291.htm#events_0001060801000400" TARGET="TEXT">EC_COMPLETE</A> events from the queue.
<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
