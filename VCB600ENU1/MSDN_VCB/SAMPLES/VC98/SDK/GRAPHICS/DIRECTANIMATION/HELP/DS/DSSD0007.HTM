<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD><TITLE>Frequently Asked Questions</TITLE>
<STYLE>
<!--
.tctop {color: blue}
.cpslug {color: blue; text-decoration: none}
-->
</STYLE>
<SCRIPT LANGUAGE="JAVASCRIPT">
//<!--
function ShowButtons() {
    if (window.top.frames.length!=0 && window.top.frames[0].ShowButtons!=null)
	window.top.frames[0].ShowButtons('/dssd0006.htm','/dssd0000.htm','/dssd0001.htm','/index.htm','/dssd0008.htm');
}
ShowButtons();
//-->
</SCRIPT>
</HEAD>
<BODY onLoad="ShowButtons()" TOPMARGIN=10 BGPROPERTIES="FIXED" BGCOLOR="#FFFFFF" LINK="#000000" VLINK="#808080" ALINK="#000000">
<FONT FACE="VERDANA,ARIAL,HELVETICA" SIZE="2">
<H2><A NAME="faq_0001010106000000">Frequently Asked Questions</A></H2>
<BR CLEAR=ALL>
<P>This section answers many frequently asked questions about DirectShow. It is divided into three parts: answers to general questions, answers to questions asked by application developers, and answers to questions asked by filter developers.

<P><B>Contents of this article:</B>
<UL><LI><A HREF="dssd0007.htm#faq_0001010106010000" TARGET="TEXT">General Questions</A>
<LI><A HREF="dssd0007.htm#faq_0001010106020000" TARGET="TEXT">Redistribution Questions</A>
<LI><A HREF="dssd0007.htm#faq_0001010106030000" TARGET="TEXT">Application Development Questions</A>
<LI><A HREF="dssd0007.htm#faq_0001010106040000" TARGET="TEXT">Filter Development Questions</A>
</UL>
<A NAME="faq_0001010106010000"></A><P><B>General Questions</B>
<P><B>Q. What are the differences between DirectShow&#153;, DirectDraw&#174;, DirectSound&#174;, and DirectX&#174;?</B>

<P><B>A.</B> For an overview of these Microsoft&#174; technologies as well as many others, see 
<A HREF="http://www.microsoft.com/directx/" TARGET="_top">http://www.microsoft.com/directx/</A>.


<P><B>Q. What operating systems does DirectShow support?</B>

<P><B>A.</B> DirectShow supports Windows&#174; 95 or later and Windows NT&#174; version 4.<I>x</I> or later.


<P><B>Q. Is there an DirectShow Hardware Compatibility List (HCL)?</B>
<P><B>A.</B> No. DirectShow uses all DirectDraw&#174; and DirectSound hardware
capabilities where they are available. Where no special hardware is available,
DirectShow uses GDI to draw video and the waveOut* Multimedia APIs to play
back audio.


<P><B>Q. What multimedia file formats does DirectShow support?</B>

<P><B>A.</B> DirectShow supports the following formats. 
<UL><LI>MIDI (.mid)
<LI>MPEG-1 (.mpg, .mpeg, .mpv, .mp2, .mpa, .mpe)
<LI>Audio-video interleaved (.avi)
<LI>Nonproprietary Apple&#174; QuickTime&#174; files (.mov, .qt)
<LI>Wave (.wav)
<LI>AU (.au, .snd)
<LI>AIFF (.aif, .aifc, .aiff)
</UL>
<P><B>Q. Where can I obtain detailed file format specifications?</B>

<P><B>A.</B> One source is <I>Encyclopedia of Graphics File Formats</I>, second edition, by James D. Murray and William vanRyper, published by O'Reilly &amp; Associates, Inc. That book describes MPEG-1, AVI, and some QuickTime file formats. See <A HREF="dssd0075.htm#avispec_0001050502030000" TARGET="TEXT">AVI 2.0 File Format Extensions</A> for more information about DirectShow's support of this format.



<P><B>Q. Does DirectShow provide video capture services?</B>

<P><B>A.</B> Yes, DirectShow provides video capture.


<P><P><B>Q. What version of Internet Explorer do I need to use DirectShow for
Web content?</B>

<P><P><B>A.</B> DirectShow is designed for Internet Explorer 3.<I>x</I> and later.


<P><P><B>Q. What HTML tags would I use with DirectShow?</B>
<P><P><B>A.</B> For information on the HTML tags to use to play movies using DirectShow, see <A HREF="dssd0011.htm#amocx_0001020102000000" TARGET="TEXT">Using the ActiveMovie Control in HTML Pages</A>.


<P><B>Q. Is there any sample code showing how to program DirectShow?</B>
<P><B>A.</B> The DirectShow SDK includes sample source code in C, C++, and
Microsoft Visual Basic&#174;. For more information, see <A HREF="dssd0347.htm#samples_0001070201000000" TARGET="TEXT">DirectShow Samples</A>.


<P><B>Q. What compiler do I need for DirectShow development?</B>
<P><B>A.</B> DirectShow was designed with Visual C++&#174; 5.<I>x</I> in mind, but any 
compiler capable of generating Component Object Model (COM) objects should 
work once the compiler's environment has been configured correctly. The base class 
libraries might need to be rebuilt to work completely since compilers can vary between 
versions.


<P><B>Q. Do I need a compiler to play back movies?</B>
<P><B>A.</B> No. Once DirectShow is installed, double-click any media file to view it. If you want more specialized applications, you can program DirectShow by using either C/C++ (in which case a compiler is required) or any Automation-compatible language (such as Visual Basic).


<P><B>Q. When will DirectShow be integrated with Microsoft's operating systems?</B>
<P><B>A.</B> DirectShow will be included in the next and future versions of Windows.


<P><B>Q. Is the source for the ActiveMovie Control (Amovie.ocx) available?</B>
<P><B>A.</B> No, the source is not available.


<P><B>Q. What DirectX technologies are available on Windows NT?</B>
<P><B>A.</B> Windows NT 5.<I>x</I> supports DirectX Foundation 5.<I>x</I>, including DirectDraw, DirectPlay&#174;, DirectSound, Direct3D&#174;, and DirectInput&#174;. Windows NT 4.<I>x</I> supports DirectDraw, DirectPlay, and DirectSound.


<P><B>Q. Can you recommend any reference books for Windows programming or COM?</B>
<P><B>A.</B> Several books from Microsoft Press, including <I>Advanced Windows</I> 
by Jeffrey Richter and <I>Understanding ActiveX and OLE</I> by David Chappell, make great 
references for DirectShow developers.


<P><B>Q. What is a</B> <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A><B>?</B>
<P><B>A.</B> A globally unique identifier (<A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A>) is a 128-bit (16-byte) integer 
that an algorithm creates. The algorithm uses several criteria, including the current 
date, time, and a machine identifier, to ensure that it will be unique. <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A>s are used 
extensively in the Component Object Model (COM) and have an important role in 
DirectShow. 


<P><B>Q. How do I get a</B> <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A><B>?</B>
<P><B>A.</B> <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A>s can be generated using Guidgen.exe. Guidgen, a Windows-native program, is included with Microsoft's Visual C++&#174; products. Developers can also use Uuidgen.exe, a console application, in the Platform SDK.


<P><B>Q. When do I need to call </B><A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A><B>?</B>
<P><B>A.</B> Whenever you need to obtain an interface for an object.


<P><B>Q. What are some typical "getting started" problems with COM?</B>
<P><B>A.</B> Some typical problems involving COM are:
<UL><LI>Forgetting to create a new <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A> is a very common problem in 
filter development. For example, if you create a new filter based on one of the sample
filters, you must create a new <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A> for your filter. Otherwise, when you install
your filter, it will overwrite the information that was already registered for the
sample filter. Create a new <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A> by using the Guidgen.exe tool. 

<LI>Omitting the address of (&amp;)' operator in the last parameter of a 
call to <A HREF="dssd0175.htm#If_0001060157030200" TARGET="TEXT">QueryInterface</A> or <A HREF="dssd0389.htm#external_00010a010900000b" TARGET="TEXT">CoCreateInstance</A> causes an exception when 
trying to use the object specified in that last parameter. The problem can be difficult to debug, 
because the void cast required prevents a compiler warning. The following example 
shows both the bad and the good syntax in a call to <B>QueryInterface</B>.
<PRE><FONT FACE="Courier" SIZE="2">
IUnknown *pUnk;

// bad -- you will hit an exception when you try to use pUnk
// HRESULT hr = pObject-&gt;QueryInterface(IID_IPersist, 
//                                     (void **)pUnk); // &lt;-- bad

// good -- note the '&amp;' is required for the last parameter
HRESULT hr = pObject-&gt;QueryInterface(IID_IPersist, 
                                     (void **)&amp;pUnk); // &lt;-- good

</FONT></PRE>
</UL>
<A NAME="faq_0001010106020000"></A><P><B>Redistribution Questions</B>
<P><B>Q. What parts of DirectShow can I redistribute?</B>
<P><B>A.</B> The SDK includes a redistributable package under the Redist directory.


<P><B>Q. Is the source to the Filter Graph Editor (Graphedt.exe) tool available? Can the Filter Graph Editor be redistributed?</B>
<P><B>A.</B> No, the source is not available, and Graphedt.exe is not redistributable.


<P><B>Q. How can I install DirectX Media redistributables package from my application?</B>
<P><B>A.</B> The DirectX Media redist package is called dxmedia.exe. An application must register itself as a client of the redist package by running dxmedia.exe with the -id switch and a unique identifer for the application, as shown in the following syntax:
<PRE><FONT FACE="Courier" SIZE="2">dxmedia.exe -id:identifier</FONT></PRE>
<P>The <I>identifier</I> should uniquely identify your application. It can be the <A HREF="dssd0397.htm#gloss_00010b0108000001" TARGET="TEXT">GUID</A> of your registered application, or a unique string. You should probably not use a string such as "game," but a more distinctive string. For example:

<PRE><FONT FACE="Courier" SIZE="2">dxmedia.exe -id:myrocketgame</FONT></PRE>
<P> &#151; or &#151;
<PRE><FONT FACE="Courier" SIZE="2">dxmedia.exe -id:my_GUID</FONT></PRE>
<P>The identifier is required. If you simply type "dxmedia.exe" or simply double-click on the Dxmedia.exe icon, nothing will be installed. 
 
<P>The same syntax is used for all platforms, Windows 95, Windows NT x86, and Windows NT Alpha. Note that each processor has its own executable (either an Alpha or an x86 version).
<P>If successful, the installation can return one of the following success codes:
<UL><LI>ERROR_SUCCESS &#151; the installation completed successfully.
<LI>ERROR_SUCCESS_REBOOT_REQUIRED

 &#151; the installation was successful, but changes will not be effective until the system is rebooted.
</UL>
<P>If unsuccessful, the installation returns an <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> describing the error; for example, E_FAIL or E_INVALIDARG.
 

<P>The installation is totally quiet, and no dialog boxes appear.


<P><B>Q. Does the install/uninstall identifier need to be a GUID?</B>
<P><B>A.</B> No, but it must be unique. GUIDs are essentially guaranteed to be unique.


<P><B>Q. Does the install package handle versioning during install? </B>
<P><B>A.</B> Yes, automatically. Files are only overwritten (after backup) if they use the same platform and are older than the files about to be installed. 


<P><B>Q. How does an application uninstall the DirectX Media package it installed during its own installation?</B>
<P><B>A.</B> The redist package includes an uninstall executable called purgedxm.exe. Uninstall by running purgedxm.exe with the application's identifier that was used during install, as shown in the following syntax:
<PRE><FONT FACE="Courier" SIZE="2">purgedxm.exe identifier</FONT></PRE>
<P><B>Note:</B> Do not use the -id switch when uninstalling.


<P><B>Q. Does the redistributable DirectX Media run-time setup install DirectX?</B>
<P><B>A.</B> It installs the DirectX Media run-time components. It also installs a minimum version of DirectX Foundation on x86 and Alpha platforms, as appropriate. The application can install DirectX Foundation separately if the full installation is needed, after the redistributable package has been installed.




<A NAME="faq_0001010106030000"></A><P><B>Application Development Questions</B>
<P><B>Q. How can you detect whether DirectShow is installed on a given machine? </B>
<P><B>A.</B> Use the following code fragment to detect whether DirectShow is installed. 
It assumes that you have already included the Streams.h header file and initialized the COM subsystem by using the <B>CoInitialize</B> function with a null parameter. It also assumes that you will uninitialize COM by using the <B>CoUninitialize</B> function before closing your application.

<PRE><FONT FACE="Courier" SIZE="2">
IGraphBuilder * lpAMovie;

HRESULT hr = CoCreateInstance(
&#009;CLSID_FilterGraph,
&#009;0,
&#009;CLSCTX_INPROC_SERVER,
&#009;IID_IGraphBuilder,
&#009;(void **) &amp;lpAMovie );


if (SUCCEEDED(hr)) {
    lpAMovie-&gt;Release();
    // DirectShow is installed
} else {
    // DirectShow is not installed
}
</FONT></PRE>
<P><B>Q. Which interfaces do applications typically use?</B>

<P><B>A.</B> <A HREF="dssd0146.htm#If_000106013a000000" TARGET="TEXT">IGraphBuilder</A>, <A HREF="dssd0150.htm#If_000106013e000000" TARGET="TEXT">IMediaEvent</A>, <A HREF="dssd0149.htm#If_000106013d000000" TARGET="TEXT">IMediaControl</A>,
and <A HREF="dssd0177.htm#If_0001060159000000" TARGET="TEXT">IVideoWindow</A>. 



<P><B>Q. How do I change the owner of the video window? </B>

<P><B>A.</B> Use the <A HREF="dssd0177.htm#If_0001060159031f00" TARGET="TEXT">IVideoWindow::put_Owner</A> method.


<P><B>Q. How do I play a movie in a specific window? </B>

<P><B>A.</B> Use <A HREF="dssd0177.htm#If_0001060159031f00" TARGET="TEXT">IVideoWindow::put_Owner</A> to specify the window you want. Set
the style of the video window to include WS_CHILD using the <A HREF="dssd0177.htm#If_0001060159032400" TARGET="TEXT">IVideoWindow::put_WindowStyle</A> method, and then position the video window inside your window using the <A HREF="dssd0177.htm#If_0001060159032700" TARGET="TEXT">IVideoWindow::SetWindowPosition</A> method. The following sample code demonstrates this
process.

<PRE><FONT FACE="Courier" SIZE="2">
#include &lt;windows.h&gt;
#include &lt;streams.h&gt;

#define FILENAME L"C:\\WIN95.AVI"

void PlayVideoInWindow(HWND hTargetWindow)

{   // PlayVideoInWindow //

    CoInitialize(NULL);

    HRESULT hr;
    IGraphBuilder *pigb;

    // Create an empty filter graph object
    hr = CoCreateInstance(CLSID_FilterGraph,
        NULL,
        CLSCTX_INPROC_SERVER,
        IID_IGraphBuilder,
        (void **)&amp;pigb);

    if (FAILED(hr))
        return;

    hr = pigb-&gt;RenderFile(FILENAME, NULL);

    if (FAILED(hr)) {
        pigb-&gt;Release();
        return;
        }   // Bail out, file probably wasn't found! //

    RECT rc;
    IVideoWindow *pivw;

    hr = pigb-&gt;QueryInterface(IID_IVideoWindow, (void **)&amp;pivw);
    pivw-&gt;put_Owner((OAHWND)hTargetWindow);

    // Here's the key: we must set the required flags, 
    //   AND set the position
    pivw-&gt;put_WindowStyle(WS_CHILD | WS_CLIPCHILDREN | WS_CLIPSIBLINGS);
    GetClientRect(hTargetWindow, &amp;rc);
    pivw-&gt;SetWindowPosition(rc.left, rc.top, rc.right rc.bottom);

    IMediaControl *pimc;

    hr = pigb-&gt;QueryInterface(IID_IMediaControl, (void **)&amp;pimc);

    long l;
    IMediaEvent *pime;

    hr = pigb-&gt;QueryInterface(IID_IMediaEvent, (void **)&amp;pime);
    pimc-&gt;Run();

    pime-&gt;WaitForCompletion(INFINITE, &amp;l);

    // The following MUST be called otherwise nasty things can happen!
    pivw-&gt;put_Owner(NULL);

    pime-&gt;Release();
    pimc-&gt;Release();
    pivw-&gt;Release();
    pigb-&gt;Release();

    CoUninitialize();

}   // PlayVideoInWindow 

</FONT></PRE>
<P><B>Q. Why doesn't my video always repaint correctly after being covered
by another window? </B>

<P><B>A.</B> You need to specify the WS_CLIPCHILDREN style for the video window's owner.


<P><B>Q. Where are the DirectShow-specific return codes</B> (<A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A>s) <B>defined? </B>
<P><B>A.</B> The error return codes specific to DirectShow are found in 
Vfwmsgs.h, located in the DirectShow SDK Include directory. More general 
errors, such as error codes returned by <A HREF="dssd0389.htm#external_00010a010900000b" TARGET="TEXT">CoCreateInstance</A>, can be found in 
\Msdev\Include\Winerror.h if you have Microsoft Developer Studio. Vfwmsgs.h
and Winerror.h also provide information about the layout of <A HREF="dssd0293.htm#errcodes_0001060a01000001" TARGET="TEXT">HRESULT</A> values. Before you 
search for a particular error in Winerror.h, you might need to convert the low 
portion to decimal, depending on the error.


<P><B>Q. How do I interpret errors from Visual Basic?</B>
<P><B>A.</B> Calls to DirectShow object methods and properties can return error codes; these codes are stored in (and can be retrieved from) the <A HREF="dssd0389.htm#external_00010a01090000b6" TARGET="TEXT">Number</A> property of the <A HREF="dssd0389.htm#external_00010a010900002d" TARGET="TEXT">Err</A> object. Error numbers can be returned in one of two forms: an DirectShow error or a Visual Basic run-time error code. DirectShow errors are referred to by number, starting at 0x80040200 (2147746304 in decimal). You can look up the error number by its hexadecimal value in the Include\Vfwmsgs.h header file. When Visual Basic can interpret the external object error, it generates a Visual Basic run-time error. For example, the E_INVALIDARG return code from an interface generates Visual Basic run-time error 5, "remote procedure call failed". In cases when Visual Basic cannot interpret a system error (such as E_ABORT), error 287 is returned in the <B>Err</B> object.


<P><B>Q. Why does the filter graph manager return E_NOTIMPL when I call </B>
<A HREF="dssd0177.htm#If_0001060159000000" TARGET="TEXT">IVideoWindow</A> <B>methods?</B>
<P><B>A.</B> The E_NOTIMPL return value indicates that no filter is in the graph that supports 
<B>IVideoWindow</B>. In other words, your graph does not contain a video renderer. One solution is to call the <A HREF="dssd0146.htm#If_000106013a030300" TARGET="TEXT">IGraphBuilder::Render</A> method and allow the filter graph manager to automatically insert any necessary filters and complete the filter graph.


<P><B>Q. Why does the filter graph manager return VFW_E_NOT_CONNECTED when I call </B>
<A HREF="dssd0177.htm#If_0001060159000000" TARGET="TEXT">IVideoWindow</A> <B>methods? </B>
<P><B>A.</B> The VFW_E_NOT_CONNECTED return value indicates that the video renderer's 
input pin is not connected.


<P><B>Q. I want to use the ActiveMovie Control to play a video, but I only want 
the image to show and not the toolbar or controls. How do I do this? </B>
<P><B>A.</B> You can turn off the controls and display through the property pages. 
Or, you can change the options programmatically by setting the <A HREF="dssd0013.htm#amocx_0001020104001d00" TARGET="TEXT">ShowControls</A> and 
<A HREF="dssd0013.htm#amocx_0001020104001e00" TARGET="TEXT">ShowDisplay</A> properties to FALSE (0).


<P><B>Q. How do enumerators work?</B>
<P><B>A.</B> Enumerators are COM objects created to traverse an ordered set. The application or filter can call a method such as <A HREF="dssd0133.htm#If_000106012d030200" TARGET="TEXT">IEnumPins::Next</A> to obtain an item from the set. Enumerators are usually matched to the data type they retrieve. In DirectShow, there are different enumerators to retrieve items such as filters, pins, and media types. 


<P><B>Q. How do I change a filter's settings without displaying the property page?</B>
<P><B>A.</B> If the filter exposes a custom interface for this purpose, then you can access the filter properties. The DirectShow SDK includes a sample called Contrast, which exposes methods such as get_ContrastLevel and put_ContrastLevel to enable you to change its properties programmatically. For more details, see the implementation of Contrast's property page. You can find a description of the Contrast filter in <A HREF="dssd0082.htm#effects_0001050701000000" TARGET="TEXT">About Effect Filters</A> and <A HREF="dssd0350.htm#samples_0001070204010000" TARGET="TEXT">Contrast Filter</A>. 


<P><B>Q. Can I change the properties of the MPEG audio decoder without displaying its property page? </B>
<P><B>A.</B> Currently the MPEG audio codec does not allow you to set its properties programmatically. 


<P><B>Q. Can DirectShow notify me of its current position on a regular basis? </B>
<P><B>A.</B> There is no callback notification of position. Use a timer and poll
for the current position by using the <A HREF="dssd0158.htm#If_0001060146030500" TARGET="TEXT">IMediaSeeking::GetCurrentPosition</A> method. 





<A NAME="faq_0001010106040000"></A><P><B>Filter Development Questions</B>
<P><B>Q. What programming languages can filters be developed in? </B>
<P><B>A.</B> You can write DirectShow filters in any language that can generate objects adhering to 
Microsoft's Component Object Model (COM). The base classes for DirectShow are written 
in C++.


<P><B>Q. Can I develop my filter using the Microsoft Foundation Classes (MFC)?</B>

<P><B>A.</B>The DirectShow class library is totally independent of MFC and contains most of the base classes you might need for 
filter development. See <A HREF="dssd0051.htm#bldvc_0001040106000000" TARGET="TEXT">Build a Filter or Application with Visual C++ 5.x</A> for information on how to build DirectShow applications with Visual C++. You can use the VC5Kit located in the Tools directory for assistance in building these applications. 


<P><B>Q. What are the differences between source, rendering, and transform filters? </B>
<P><B>A.</B> Source filters form the point of origin for data, while rendering 
filters present the data in a final format on various devices such as a video card, 
audio card, disk file, and so on. Transform filters manipulate, modify, or alter the 
data in some way. 


<P><B>Q. How do I install my filter? </B>
<P><B>A.</B> For information about how to install (self-register) a filter,
see <A HREF="dssd0053.htm#register_0001040108000000" TARGET="TEXT">Register DirectShow Objects</A> and the <A HREF="dssd0104.htm#If_0001060110000000" TARGET="TEXT">IAMovieSetup</A> interface.


<P><B>Q. Where do I install my filter on an end-user system? </B>
<P><B>A.</B> You can install the filter anywhere you want, because the filter registration
process records the filter's full path and file name at the time of registration. 
There is no need to put your filter in the Windows System or System32 directory.


<P><B>Q. What causes the Filter Graph Editor to report that "The filter could not be created. 
Resources used by this filter might already be in use." when I try to insert a filter? </B>
<P><B>A.</B> The Filter Graph Editor (Graphedt.exe) displays this message when it can't find the filter's .ax file. The filter has probably been moved, renamed, deleted, or was not properly set up. It needs to be properly registered. For information about how to self-register a filter, see <A HREF="dssd0053.htm#register_0001040108000000" TARGET="TEXT">Register DirectShow Objects</A> and the <A HREF="dssd0104.htm#If_0001060110000000" TARGET="TEXT">IAMovieSetup</A> interface.


<P><B>Q. What is the resolution of time stamps in DirectShow?</B>
<P><B>A.</B> The minimum resolution is 100 nanoseconds.


<P><B>Q. Can a filter graph have only one filter that performs the work of source, 
transform, and renderer? </B>
<P><B>A.</B> Yes, but to take advantage of DirectShow's "plug-in" nature, it is best to use 
different combinations of filters chained together. This also provides easier code reuse and flexibility in design, and is strongly recommended.


<P><B>Q. Can I have a filter with many input and output pins (with some fixed
one-to-one correspondence between them)? </B>
<P><B>A.</B> Yes. Ensure that you implement the <A HREF="dssd0165.htm#If_000106014d030d00" TARGET="TEXT">IPin::QueryInternalConnections</A> method on every pin. Without this, the graph builder will assume that each input pin streams through to every output pin. While you can have a filter with many input and output pins, it's often more desirable to have several 
filters. Otherwise, you might find yourself writing more code (overriding more and more functions from the base classes) than if you just use an individual filter for each stream.


<P><B>Q. Why does the graph builder stream each of my input pins through to every output pin? </B>
<P><B>A.</B> This is the default behavior. Implement the <A HREF="dssd0165.htm#If_000106014d030d00" TARGET="TEXT">IPin::QueryInternalConnections</A> method on every pin to avoid this.


<P><B>Q. Can I use a filter outside an DirectShow filter graph? </B>
<P><B>A.</B> No, filters are integrated with the DirectShow architecture and 
require a filter graph.


<P><B>Q. How do I determine the number of pins on a filter? </B>
<P><B>A.</B> Call the <A HREF="dssd0116.htm#If_000106011c030100" TARGET="TEXT">IBaseFilter::EnumPins</A> method, and then keep calling the <A HREF="dssd0133.htm#If_000106012d030200" TARGET="TEXT">IEnumPins::Next</A> method until you don't get any more pins. 


<P><B>Q. At what privilege ring do filters run?</B>
<P><B>A.</B> Filters in DirectShow run at user-privilege level three (ring three on x86 processors).


<P><B>Q. How do filters communicate with one another?</B>
<P><B>A.</B> Filters typically communicate with one another through their pins. 
Pins negotiate a common format and transport for exchanging data.


<P><B>Q. Can I test my filter with the Filter Graph Editor (Graphedt.exe)? </B>
<P><B>A.</B> Graphedt was designed to help filter developers visualize the 
connections and interaction between filters during filter development. It is 
not meant as a robust test platform.


<P><B>Q. Can pin direction change dynamically?</B>
<P><B>A.</B> DirectShow pins are not designed to have their direction changed.
You could create two pins, one for each direction, and use a single piece of code to 
drive both pins.



<P><B>Q. Why is the MPEG audio codec filter sometimes missing from an auto-rendered graph? How can the MPEG stream splitter audio output pin connect directly to an audio renderer?</B>
<P><B>A.</B> Codec filters are only required by the renderer if the audio driver does not support a given audio format. Renderers often query the audio driver inside <B>CheckMediaType</B> to determine if the proposed format is supported, and if supported, pass the media samples directly to the audio subsystem when the graph is run. If the driver incorrectly indicates a format is supported, the most obvious symptom is garbled audio. You then need to get corrected drivers from your audio board manufacturer.


<P><P><FONT FACE="MS SANS SERIF" SIZE="1" COLOR="BLACK">
<A CLASS=cpslug HREF="copyrite.htm" TARGET="TEXT">&#169; 1997 Microsoft Corporation. All rights reserved. Terms of Use.</A>
</FONT>
<BR CLEAR=ALL><P>
</FONT><P>
</BODY></HTML>
